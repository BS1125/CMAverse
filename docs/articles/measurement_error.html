<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sensitivity Analysis for Measurement Error â€¢ CMAverse</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Sensitivity Analysis for Measurement Error">
<meta property="og:description" content="CMAverse">
<meta property="og:image" content="https://bs1125.github.io/CMAverse/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CMAverse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/overview.html">Overview of Modeling Approaches</a>
</li>
<li>
  <a href="../articles/quickstart.html">Quickstart</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/single_mediator.html">Statistical Modeling with a Single Mediator</a>
    </li>
    <li>
      <a href="../articles/multiple_mediators.html">Statistical Modeling with Multiple Mediators</a>
    </li>
    <li>
      <a href="../articles/case_control.html">Statistical Modeling for a Case Control Study</a>
    </li>
    <li>
      <a href="../articles/multiple_imputation.html">Statistical Modeling with Missing Data</a>
    </li>
    <li>
      <a href="../articles/post_exposure_confounding.html">Statistical Modeling with Post-exposure Confounding</a>
    </li>
    <li>
      <a href="../articles/measurement_error.html">Sensitivity Analysis for Measurement Error</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
<li>
  <a href="https://github.com/BS1125/CMAverse/">
    <span class="fa fa-github fa-lg"></span>
     
    GitHub
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="measurement_error_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Sensitivity Analysis for Measurement Error</h1>
            
            <h4 class="date">2020-10-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/BS1125/CMAverse/blob/master/vignettes/measurement_error.Rmd"><code>vignettes/measurement_error.Rmd</code></a></small>
      <div class="hidden name"><code>measurement_error.Rmd</code></div>

    </div>

    
    
<p>This example demonstrates how to conduct sensitivity analysis for measurement error by using <code>cmsens</code>. For this purpose, we simulate some data containing a continuous baseline confounder <span class="math inline">\(C_1\)</span>, a binary baseline confounder <span class="math inline">\(C_2\)</span>, a binary exposure <span class="math inline">\(A\)</span>, a binary mediator <span class="math inline">\(M\)</span> and a binary outcome <span class="math inline">\(Y\)</span>. The true regression models for <span class="math inline">\(A\)</span>, <span class="math inline">\(M\)</span> and <span class="math inline">\(Y\)</span> are: <span class="math display">\[logit(E(A|C_1,C_2))=0.2+0.5C_1+0.1C_2\]</span> <span class="math display">\[logit(E(M|A,C_1,C_2))=1+2A+1.5C_1+0.8C_2\]</span> <span class="math display">\[logit(E(Y|A,M,C_1,C_2)))=-3-0.4A-1.2M+0.5AM+0.3C_1-0.6C_2\]</span></p>
<p>Then, we generate some measurement errors for <span class="math inline">\(C_1\)</span> and <span class="math inline">\(A\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">expit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10000</span>
<span class="va">C1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="va">C1_error</span> <span class="op">&lt;-</span> <span class="va">C1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">0.05</span><span class="op">)</span>
<span class="va">C2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.6</span><span class="op">)</span>
<span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fu">expit</span><span class="op">(</span><span class="fl">0.2</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">C1</span> <span class="op">+</span> <span class="fl">0.1</span><span class="op">*</span><span class="va">C2</span><span class="op">)</span><span class="op">)</span>
<span class="va">mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.9</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.9</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">A_error</span> <span class="op">&lt;-</span> <span class="va">A</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">A_error</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">A_error</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">A_error</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,
           prob <span class="op">=</span> <span class="va">mc</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fu">expit</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">A</span> <span class="op">+</span> <span class="fl">1.5</span><span class="op">*</span><span class="va">C1</span> <span class="op">+</span> <span class="fl">0.8</span><span class="op">*</span><span class="va">C2</span><span class="op">)</span><span class="op">)</span>
<span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fu">expit</span><span class="op">(</span><span class="op">-</span><span class="fl">3</span> <span class="op">-</span> <span class="fl">0.4</span><span class="op">*</span><span class="va">A</span> <span class="op">-</span> <span class="fl">1.2</span><span class="op">*</span><span class="va">M</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">A</span><span class="op">*</span><span class="va">M</span> <span class="op">+</span> <span class="fl">0.3</span><span class="op">*</span><span class="va">C1</span> <span class="op">-</span> <span class="fl">0.6</span><span class="op">*</span><span class="va">C2</span><span class="op">)</span><span class="op">)</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">A_error</span>, <span class="va">M</span>, <span class="va">Y</span>, <span class="va">C1</span>, <span class="va">C1_error</span>, <span class="va">C2</span><span class="op">)</span></pre></div>
<p>The DAG for this scientific setting is:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bs1125.github.io/CMAverse/">CMAverse</a></span><span class="op">)</span>
<span class="fu"><a href="../reference/cmdag.html">cmdag</a></span><span class="op">(</span>outcome <span class="op">=</span> <span class="st">"Y"</span>, exposure <span class="op">=</span> <span class="st">"A"</span>, mediator <span class="op">=</span> <span class="st">"M"</span>,
      basec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C1"</span>, <span class="st">"C2"</span><span class="op">)</span>, postc <span class="op">=</span> <span class="cn">NULL</span>, node <span class="op">=</span> <span class="cn">TRUE</span>, text_col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></pre></div>
<p><img src="measurement_error_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div id="a-continuous-variable-measured-with-error" class="section level2">
<h2 class="hasAnchor">
<a href="#a-continuous-variable-measured-with-error" class="anchor"></a>A Continuous Variable Measured with Error</h2>
<p>Firstly, we assume <span class="math inline">\(C1\)</span> was measured with error. <span class="math inline">\(C_1\)</span> is continuous, so the measurement error can be corrected by regression calibration or SIMEX. We use the regression-based approach for illustration. The naive results obtained by fitting data with measurement error:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="va">res_naive_cont</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cmest.html">cmest</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, model <span class="op">=</span> <span class="st">"rb"</span>, outcome <span class="op">=</span> <span class="st">"Y"</span>, exposure <span class="op">=</span> <span class="st">"A"</span>,
                        mediator <span class="op">=</span> <span class="st">"M"</span>, basec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C1_error"</span>, <span class="st">"C2"</span><span class="op">)</span>, EMint <span class="op">=</span> <span class="cn">TRUE</span>,
                        mreg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"logistic"</span><span class="op">)</span>, yreg <span class="op">=</span> <span class="st">"logistic"</span>,
                        astar <span class="op">=</span> <span class="fl">0</span>, a <span class="op">=</span> <span class="fl">1</span>, mval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, yref <span class="op">=</span> <span class="fl">0</span>,
                        estimation <span class="op">=</span> <span class="st">"paramfunc"</span>, inference <span class="op">=</span> <span class="st">"delta"</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">res_naive_cont</span><span class="op">)</span></pre></div>
<pre><code>## Causal Mediation Analysis via the Regression-based Approach
##  
## Closed-form parameter function estimation with 
##  delta method standard errors, confidence intervals and p-values 
##  
##                 Estimate Std.error   95% CIL 95% CIU   P.val    
## Rcde             1.24383   0.22304   0.87524   1.768 0.22367    
## Rpnde            1.01905   0.17645   0.72578   1.431 0.91323    
## Rtnde            1.20938   0.21034   0.86004   1.701 0.27437    
## Rpnie            0.80077   0.05414   0.70138   0.914 0.00102 ** 
## Rtnie            0.95034   0.06599   0.82942   1.089 0.46320    
## Rte              0.96844   0.15560   0.70683   1.327 0.84179    
## ERcde            0.18846   8.40147 -16.27812  16.655 0.98210    
## ERintref        -0.16941   0.16640  -0.49555   0.157 0.30864    
## ERintmed         0.14862   0.09996  -0.04731   0.345 0.13709    
## ERpnie          -0.19923   0.08786  -0.37142  -0.027 0.02335 *  
## ERcde(prop)     -5.97114   0.05414  -6.07726  -5.865 &lt; 2e-16 ***
## ERintref(prop)   5.36768  34.38901 -62.03355  72.769 0.87596    
## ERintmed(prop)  -4.70891  26.42572 -56.50236  47.085 0.85857    
## ERpnie(prop)     6.31237  23.17884 -39.11733  51.742 0.78537    
## pm               1.60346  31.15632 -59.46181  62.669 0.95895    
## int              0.65876   3.24847  -5.70811   7.026 0.83930    
## pe               6.97114  34.38901 -60.43008  74.372 0.83936    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Reference values: 
## $a
## [1] 1
## 
## $astar
## [1] 0
## 
## $yref
## [1] 0
## 
## $mval
## $mval[[1]]
## [1] 1
## 
## 
## $basecval
## $basecval[[1]]
## [1] 0.996522
## 
## $basecval[[2]]
## [1] 0.5936</code></pre>
<p>The results corrected by regression calibration:</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="va">res_rc_cont</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cmsens.html">cmsens</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">res_naive_cont</span>, sens <span class="op">=</span> <span class="st">"me"</span>, MEmethod <span class="op">=</span> <span class="st">"rc"</span>, 
                      MEvariable <span class="op">=</span> <span class="st">"C1_error"</span>, MEvartype <span class="op">=</span> <span class="st">"con"</span>, MEerror <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">res_rc_cont</span><span class="op">)</span></pre></div>
<pre><code>## Sensitivity Analysis For Measurement Error 
##  
## The variable measured with error: C1_error
## Type of the variable measured with error: continuous
## 
## Measurement error 1: 
## [1] 0.05
## 
## Measurement error correction for measurement error 1: 
##                 Estimate Std.error   95% CIL 95% CIU    P.val    
## Rcde             1.24332   0.21790   0.88187   1.753 0.214000    
## Rpnde            1.01851   0.51560   0.37762   2.747 0.971104    
## Rtnde            1.20880   0.21487   0.85320   1.713 0.286051    
## Rpnie            0.80064   0.05377   0.70189   0.913 0.000931 ***
## Rtnie            0.95024   0.40376   0.41320   2.185 0.904375    
## Rte              0.96782   0.15935   0.70088   1.336 0.842532    
## ERcde            0.18801  17.92074 -34.93600  35.312 0.991629    
## ERintref        -0.16951   0.16191  -0.48684   0.148 0.295139    
## ERintmed         0.14867   0.50414  -0.83942   1.137 0.768070    
## ERpnie          -0.19936   0.44221  -1.06608   0.667 0.652122    
## ERcde(prop)     -5.84268   0.05377  -5.94808  -5.737  &lt; 2e-16 ***
## ERintref(prop)   5.26756  33.30469 -60.00844  70.544 0.874329    
## ERintmed(prop)  -4.62011  25.15247 -53.91805  44.678 0.854261    
## ERpnie(prop)     6.19523  22.05610 -37.03393  49.424 0.778799    
## pm               1.57512  30.72226 -58.63939  61.790 0.959111    
## int              0.64746   3.09806  -5.42463   6.720 0.834458    
## pe               6.84268  33.30469 -58.43331  72.119 0.837215    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## ----------------------------------------------------------------</code></pre>
<p>The results corrected by SIMEX:</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="va">res_simex_cont</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cmsens.html">cmsens</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">res_naive_cont</span>, sens <span class="op">=</span> <span class="st">"me"</span>, MEmethod <span class="op">=</span> <span class="st">"simex"</span>, 
                         MEvariable <span class="op">=</span> <span class="st">"C1_error"</span>, MEvartype <span class="op">=</span> <span class="st">"con"</span>, MEerror <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">res_simex_cont</span><span class="op">)</span></pre></div>
<pre><code>## Sensitivity Analysis For Measurement Error 
##  
## The variable measured with error: C1_error
## Type of the variable measured with error: continuous
## 
## Measurement error 1: 
## [1] 0.05
## 
## Measurement error correction for measurement error 1: 
##                 Estimate Std.error   95% CIL 95% CIU   P.val    
## Rcde             1.24357   0.22301   0.87503   1.767 0.22415    
## Rpnde            1.01920   0.17645   0.72592   1.431 0.91255    
## Rtnde            1.20915   0.21032   0.85985   1.700 0.27490    
## Rpnie            0.80111   0.05410   0.70180   0.914 0.00102 ** 
## Rtnie            0.95042   0.06585   0.82975   1.089 0.46297    
## Rte              0.96867   0.15569   0.70691   1.327 0.84299    
## ERcde            0.18834   8.50887 -16.48873  16.865 0.98234    
## ERintref        -0.16914   0.16647  -0.49542   0.157 0.30962    
## ERintmed         0.14836   0.09979  -0.04724   0.344 0.13711    
## ERpnie          -0.19889   0.08769  -0.37076  -0.027 0.02333 *  
## ERcde(prop)     -6.01072   0.05410  -6.11675  -5.905 &lt; 2e-16 ***
## ERintref(prop)   5.39808  34.85624 -62.91889  73.715 0.87693    
## ERintmed(prop)  -4.73472  26.78430 -57.23098  47.762 0.85969    
## ERpnie(prop)     6.34736  23.48910 -39.69042  52.385 0.78699    
## pm               1.61264  31.57520 -60.27361  63.499 0.95927    
## int              0.66336   3.29679  -5.79824   7.125 0.84053    
## pe               7.01072  34.85624 -61.30625  75.328 0.84060    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## ----------------------------------------------------------------</code></pre>
</div>
<div id="a-categorical-variable-measured-with-error" class="section level2">
<h2 class="hasAnchor">
<a href="#a-categorical-variable-measured-with-error" class="anchor"></a>A Categorical Variable Measured with Error</h2>
<p>Then, we assume <span class="math inline">\(A\)</span> was measured with error. <span class="math inline">\(A\)</span> is categorical, so only SIMEX can be used. The naive results obtained by fitting data with measurement error:</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="va">res_naive_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cmest.html">cmest</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, model <span class="op">=</span> <span class="st">"rb"</span>, outcome <span class="op">=</span> <span class="st">"Y"</span>, exposure <span class="op">=</span> <span class="st">"A_error"</span>,
                       mediator <span class="op">=</span> <span class="st">"M"</span>, basec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C1"</span>, <span class="st">"C2"</span><span class="op">)</span>, EMint <span class="op">=</span> <span class="cn">TRUE</span>,
                       mreg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"logistic"</span><span class="op">)</span>, yreg <span class="op">=</span> <span class="st">"logistic"</span>,
                       astar <span class="op">=</span> <span class="fl">0</span>, a <span class="op">=</span> <span class="fl">1</span>, mval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, yref <span class="op">=</span> <span class="fl">0</span>,
                       estimation <span class="op">=</span> <span class="st">"paramfunc"</span>, inference <span class="op">=</span> <span class="st">"delta"</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">res_naive_cat</span><span class="op">)</span></pre></div>
<pre><code>## Causal Mediation Analysis via the Regression-based Approach
##  
## Closed-form parameter function estimation with 
##  delta method standard errors, confidence intervals and p-values 
##  
##                Estimate Std.error  95% CIL 95% CIU   P.val    
## Rcde            1.08912   0.18279  0.78381   1.513 0.61100    
## Rpnde           0.98700   0.15917  0.71952   1.354 0.93531    
## Rtnde           1.06299   0.17173  0.77449   1.459 0.70532    
## Rpnie           0.86553   0.04070  0.78932   0.949 0.00213 ** 
## Rtnie           0.93218   0.04836  0.84205   1.032 0.17582    
## Rte             0.92005   0.14238  0.67934   1.246 0.59029    
## ERcde           0.07373   1.71924 -3.29591   3.443 0.96579    
## ERintref       -0.08673   0.14960 -0.37995   0.206 0.56208    
## ERintmed        0.06753   0.08188 -0.09296   0.228 0.40955    
## ERpnie         -0.13447   0.06388 -0.25966  -0.009 0.03528 *  
## ERcde(prop)    -0.92222   0.04070 -1.00199  -0.842 &lt; 2e-16 ***
## ERintref(prop)  1.08489   3.45691 -5.69054   7.860 0.75365    
## ERintmed(prop) -0.84468   2.06437 -4.89077   3.201 0.68241    
## ERpnie(prop)    1.68201   1.60658 -1.46682   4.831 0.29512    
## pm              0.83733   3.03652 -5.11414   6.789 0.78274    
## int             0.24020   0.45912 -0.65966   1.140 0.60085    
## pe              1.92222   3.45691 -4.85321   8.698 0.57818    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Reference values: 
## $a
## [1] 1
## 
## $astar
## [1] 0
## 
## $yref
## [1] 0
## 
## $mval
## $mval[[1]]
## [1] 1
## 
## 
## $basecval
## $basecval[[1]]
## [1] 0.9967315
## 
## $basecval[[2]]
## [1] 0.5936</code></pre>
<p>The results corrected by SIMEX:</p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="va">res_simex_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cmsens.html">cmsens</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">res_naive_cat</span>, sens <span class="op">=</span> <span class="st">"me"</span>, MEmethod <span class="op">=</span> <span class="st">"simex"</span>, 
                         MEvariable <span class="op">=</span> <span class="st">"A_error"</span>, MEvartype <span class="op">=</span> <span class="st">"cat"</span>, MEerror <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mc</span><span class="op">)</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">res_simex_cat</span><span class="op">)</span></pre></div>
<pre><code>## Sensitivity Analysis For Measurement Error 
##  
## The variable measured with error: A_error
## Type of the variable measured with error: categorical
## 
## Measurement error 1: 
##      [,1] [,2]
## [1,]  0.9  0.1
## [2,]  0.1  0.9
## 
## Measurement error correction for measurement error 1: 
##                Estimate Std.error  95% CIL 95% CIU   P.val    
## Rcde            1.11696   0.23958  0.73360   1.701 0.60609    
## Rpnde           0.96730   0.20112  0.64354   1.454 0.87296    
## Rtnde           1.09045   0.22744  0.72455   1.641 0.67804    
## Rpnie           0.82467   0.05202  0.72876   0.933 0.00224 ** 
## Rtnie           0.92966   0.06727  0.80674   1.071 0.31347    
## Rte             0.89926   0.17449  0.61478   1.315 0.58423    
## ERcde           0.09294   1.48233 -2.81237   2.998 0.95000    
## ERintref       -0.12564   0.18747 -0.49307   0.242 0.50272    
## ERintmed        0.10729   0.10510 -0.09871   0.313 0.30735    
## ERpnie         -0.17533   0.08991 -0.35155   0.001 0.05118 .  
## ERcde(prop)    -0.92262   0.05202 -1.02459  -0.821 &lt; 2e-16 ***
## ERintref(prop)  1.24722   3.41032 -5.43688   7.931 0.71457    
## ERintmed(prop) -1.06501   2.29278 -5.55878   3.429 0.64229    
## ERpnie(prop)    1.74041   1.95713 -2.09550   5.576 0.37386    
## pm              0.67540   3.09718 -5.39497   6.746 0.82738    
## int             0.18221   0.33721 -0.47870   0.843 0.58895    
## pe              1.92262   3.41032 -4.76148   8.607 0.57291    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## ----------------------------------------------------------------</code></pre>
<p>Compare the error-corrected results with the true results:</p>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="va">res_true</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cmest.html">cmest</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, model <span class="op">=</span> <span class="st">"rb"</span>, outcome <span class="op">=</span> <span class="st">"Y"</span>, exposure <span class="op">=</span> <span class="st">"A"</span>,
                       mediator <span class="op">=</span> <span class="st">"M"</span>, basec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C1"</span>, <span class="st">"C2"</span><span class="op">)</span>, EMint <span class="op">=</span> <span class="cn">TRUE</span>,
                       mreg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"logistic"</span><span class="op">)</span>, yreg <span class="op">=</span> <span class="st">"logistic"</span>,
                       astar <span class="op">=</span> <span class="fl">0</span>, a <span class="op">=</span> <span class="fl">1</span>, mval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, yref <span class="op">=</span> <span class="fl">0</span>,
                       estimation <span class="op">=</span> <span class="st">"paramfunc"</span>, inference <span class="op">=</span> <span class="st">"delta"</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">res_true</span><span class="op">)</span></pre></div>
<pre><code>## Causal Mediation Analysis via the Regression-based Approach
##  
## Closed-form parameter function estimation with 
##  delta method standard errors, confidence intervals and p-values 
##  
##                 Estimate Std.error   95% CIL 95% CIU   P.val    
## Rcde             1.24309   0.22291   0.87472   1.767 0.22495    
## Rpnde            1.01814   0.17635   0.72506   1.430 0.91733    
## Rtnde            1.20855   0.21018   0.85947   1.699 0.27607    
## Rpnie            0.80040   0.05419   0.70093   0.914 0.00101 ** 
## Rtnie            0.95009   0.06605   0.82906   1.089 0.46146    
## Rte              0.96733   0.15543   0.70599   1.325 0.83621    
## ERcde            0.18777   7.88784 -15.27212  15.648 0.98101    
## ERintref        -0.16963   0.16621  -0.49539   0.156 0.30746    
## ERintmed         0.14878   0.10003  -0.04729   0.345 0.13694    
## ERpnie          -0.19960   0.08790  -0.37188  -0.027 0.02317 *  
## ERcde(prop)     -5.74662   0.05419  -5.85284  -5.640 &lt; 2e-16 ***
## ERintref(prop)   5.19141  32.11420 -57.75127  68.134 0.87158    
## ERintmed(prop)  -4.55337  24.66335 -52.89265  43.786 0.85353    
## ERpnie(prop)     6.10859  21.62860 -36.28269  48.500 0.77761    
## pm               1.55521  29.09367 -55.46733  58.578 0.95737    
## int              0.63803   3.03635  -5.31311   6.589 0.83357    
## pe               6.74662  32.11420 -56.19606  69.689 0.83360    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Reference values: 
## $a
## [1] 1
## 
## $astar
## [1] 0
## 
## $yref
## [1] 0
## 
## $mval
## $mval[[1]]
## [1] 1
## 
## 
## $basecval
## $basecval[[1]]
## [1] 0.9967315
## 
## $basecval[[2]]
## [1] 0.5936</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Baoyi Shi, <a href="https://scholar.harvard.edu/cchoirat">Christine Choirat</a>, <a href="https://www.lindavaleri.com/">Linda Valeri</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
