---
title: "Model Comparison"
author: "Baoyi Shi"
output: 
  pdf_document:
    number_sections: true
header-includes:
- \usepackage{caption}
---

```{r echo=FALSE,warning=FALSE,message=FALSE}
library(mediation)
library(CMA)
df_int <- read.csv("int_data_10000.txt", sep = " ")
df_noint <- read.csv("noint_data_10000.txt", sep = " ")
df_mulipleM_noint <- read.csv("multipleM_noint_data_10000.txt", sep = " ")
df_mulipleM_EMint <- read.csv("multipleM_EMint_data_10000.txt", sep = " ")
df_mulipleM_MMint <- read.csv("multipleM_MMint_data_10000.txt", sep = " ")
df_mulipleM_mint <- read.csv("multipleM_mint_data_10000.txt", sep = " ")
```

# Case 1: Continuous Outcome and Continuous Mediator

## Case 1-1: Continuous Outcome and Single Continuous Mediator Without Exposure-mediator Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the mediator M from $N((\beta_0+\beta_1*A+\beta_2*C),\sigma_M^2)$.

4. Simulate the outcome Y from $N(\theta_0+\theta_1A+\theta_2M+\theta_4C,\sigma_Y^2)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_4$ & $\beta_0$ & $\beta_1$ & $\beta_2$ & P(A=1) & $\mu_C$ & $\sigma_C$ & $\sigma_M$ & $\sigma_Y$\\ \hline
10000&-5&0.8&1.8&0.1&-0.25&0.5&0.2&0.4&1&1&0.1&0.2 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the mediator:
$$E[M|a,c]=\beta_0+\beta_1a+\beta_2c$$

True model for the outcome:
$$E[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m^*+\theta_4c$$

### Causal Effects and Standard Errors Estimated By the Structural Equation Model with 3 Different Estimation Method

#### Delta Method

```{r}
causal_mediation(data = df_noint, model = "standard", est.method = "delta", 
                 outcome = "contY_contM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = FALSE,
                 yreg = "linear", mreg = "linear")
```

#### Bootstrapping

```{r}
causal_mediation(data = df_noint, model = "standard", est.method = "bootstrap", 
                 outcome = "contY_contM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = FALSE,
                 yreg = "linear", mreg = "linear", nboot = 500)
```

#### Simulation-based Approach

```{r}
causal_mediation(data = df_noint, model = "standard", est.method = "simulation", 
                 outcome = "contY_contM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = FALSE,
                 yreg = "linear", mreg = "linear",nsims = 500)[1:2]
```

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_noint, model = "ne",
                 outcome = "contY_contM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = FALSE,
                 yreg = "linear")
```

### Causal Effects and Standard Errors Estimated By the regression-based approach 

#### Bootstrapping

```{r}
causal_mediation(data = df_noint, model = "rb", est.method = "bootstrap",
                 outcome = "contY_contM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = FALSE,
                 yreg = "linear", mreg = "linear", nboot = 500)
```

#### Simulation-based Approach

```{r}
causal_mediation(data = df_noint, model = "rb", est.method = "simulation",
                 outcome = "contY_contM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = FALSE,
                 yreg = "linear", mreg = "linear", nsims = 500)[1:2]
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_noint, model = "wb",
                 outcome = "contY_contM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = FALSE,
                 yreg = "linear")
```

## Case 1-2: Continuous Outcome and Single Continuous Mediator With Exposure-mediator Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the mediator M from $N((\beta_0+\beta_1*A+\beta_2*C),\sigma_M^2)$.

4. Simulate the outcome Y from $N(\theta_0+\theta_1A+\theta_2M+\theta_3AM+\theta_4C,\sigma_Y^2)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_3$ & $\theta_4$ & $\beta_0$ & $\beta_1$ & $\beta_2$ & P(A=1) & $\mu_C$ & $\sigma_C$ & $\sigma_M$ & $\sigma_Y$\\ \hline
10000&-5&0.8&1.8&0.2&0.1&-0.25&0.5&0.2&0.4&1&1&0.1&0.2 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the mediator:
$$E[M|a,c]=\beta_0+\beta_1a+\beta_2c$$

True model for the outcome:
$$E[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m^*+\theta_3am^*+\theta_4c$$

### Causal Effects and Standard Errors Estimated By the Structural Equation Model with 3 Different Estimation Method

#### Delta Method

```{r}
causal_mediation(data = df_int, model = "standard", est.method = "delta", 
                 outcome = "contY_contM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = TRUE,
                 yreg = "linear", mreg = "linear")
```

#### Bootstrapping

```{r}
causal_mediation(data = df_int, model = "standard", est.method = "bootstrap", 
                 outcome = "contY_contM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = TRUE,
                 yreg = "linear", mreg = "linear", nboot = 500)
```

#### Simulation-based Approach

```{r}
causal_mediation(data = df_int, model = "standard", est.method = "simulation", 
                 outcome = "contY_contM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = TRUE,
                 yreg = "linear", mreg = "linear",nsims = 500)[1:2]
```

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_int, model = "ne",
                 outcome = "contY_contM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = TRUE,
                 yreg = "linear")
```

### Causal Effects and Standard Errors Estimated By the regression-based approach

#### Bootstrapping

```{r}
causal_mediation(data = df_int, model = "rb", est.method = "bootstrap",
                 outcome = "contY_contM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = TRUE,
                 yreg = "linear", mreg = "linear", nboot = 500)
```

#### Simulation-based Approach

```{r}
causal_mediation(data = df_int, model = "rb", est.method = "simulation",
                 outcome = "contY_contM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = TRUE,
                 yreg = "linear", mreg = "linear", nsims = 500)[1:2]
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_int, model = "wb",
                 outcome = "contY_contM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = TRUE,
                 yreg = "linear", nboot = 500)
```

## Case 1-3: Continuous Outcome and Multiple Continuous Mediators Without Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the first mediator M1 from $N((\beta_{01}+\beta_{11}*A+\beta_{21}*C),\sigma_{M1}^2)$ and the second mediator M2 from $N((\beta_{02}+\beta_{12}*A+\beta_{22}*C),\sigma_{M2}^2)$.

4. Simulate the outcome Y from $N(\theta_0+\theta_1A+\theta_2M1+\theta_3M2+\theta_4C,\sigma_Y^2)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_3$ & $\theta_4$ & $\beta_{01}$ & $\beta_{11}$ & $\beta_{21}$ \\ \hline
10000&-5&0.8&1.8&1.2&0.1&-0.25&0.5&0.2 \\ \hline
$\beta_{02}$ & $\beta_{12}$ & $\beta_{22}$ & P(A=1) & $\mu_C$ & $\sigma_C$ & $\sigma_{M1}$ & $\sigma_{M2}$ & $\sigma_Y$\\ \hline
-0.3&0.4&0.3&0.4&1&1&0.1&0.1&0.2 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the first mediator:
$$E[M1|a,c]=\beta_{01}+\beta_{11}a+\beta_{21}c$$

True model for the second mediator:
$$E[M2|a,c]=\beta_{02}+\beta_{12}a+\beta_{22}c$$

True model for the outcome:
$$E[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m1^*+\theta_3m2^*+\theta_4c$$

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_mulipleM_noint, model = "ne",
                 outcome = "contY_2contM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), covariates = "C", 
                 yreg = "linear")
```

### Causal Effects and Standard Errors Estimated By the regression-based approach

#### Bootstrapping

```{r}
causal_mediation(data = df_mulipleM_noint, model = "rb", est.method = "bootstrap",
                 outcome = "contY_2contM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), covariates = "C",
                 yreg = "linear", m_star = c(0,0), mreg = c("linear","linear"), nboot = 500)
```

#### Simulation-based Approach

```{r}
causal_mediation(data = df_mulipleM_noint, model = "rb", est.method = "simulation",
                 outcome = "contY_2contM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), covariates = "C",
                 yreg = "linear", m_star = c(0,0), mreg = c("linear","linear"), nsims = 500)[1:2]
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_mulipleM_noint, model = "wb",
                 outcome = "contY_2contM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), covariates = "C",
                 yreg = "linear", m_star = c(0,0), nboot = 500)
```

## Case 1-4: Continuous Outcome and Multiple Continuous Mediators With Exposure-mediator Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the first mediator M1 from $N((\beta_{01}+\beta_{11}*A+\beta_{21}*C),\sigma_{M1}^2)$ and the second mediator M2 from $N((\beta_{02}+\beta_{12}*A+\beta_{22}*C),\sigma_{M2}^2)$.

4. Simulate the outcome Y from $N(\theta_0+\theta_1A+\theta_2M1+\theta_3M2+\theta_4AM1+\theta_5AM2+\theta_6C,\sigma_Y^2)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_3$ & $\theta_4$ & $\theta_5$ & $\theta_6$ & $\beta_{01}$ & $\beta_{11}$ \\ \hline
10000&-5&0.8&1.8&1.2&0.6&0.4&0.1&-0.25&0.5 \\ \hline
$\beta_{21}$ & $\beta_{02}$ & $\beta_{12}$ & $\beta_{22}$ & P(A=1) & $\mu_C$ & $\sigma_C$ & $\sigma_{M1}$ & $\sigma_{M2}$ & $\sigma_Y$\\ \hline
0.2&-0.3&0.4&0.3&0.4&1&1&0.1&0.1&0.2 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the first mediator:
$$E[M1|a,c]=\beta_{01}+\beta_{11}a+\beta_{21}c$$

True model for the second mediator:
$$E[M2|a,c]=\beta_{02}+\beta_{12}a+\beta_{22}c$$

True model for the outcome:
$$E[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m1^*+\theta_3m2^*+\theta_4am1^*+\theta_5am2^*+\theta_6c$$

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_mulipleM_EMint, model = "ne",
                 outcome = "contY_2contM_EMint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), EMint = TRUE, EMint.terms = c("A*M_cont1", "A*M_cont2"),
                 covariates = "C", yreg = "linear")
```

### Causal Effects and Standard Errors Estimated By the regression-based approach

#### Bootstrapping

```{r}
causal_mediation(data = df_mulipleM_EMint, model = "rb", est.method = "bootstrap",
                 outcome = "contY_2contM_EMint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), covariates = "C",
                 EMint = TRUE, EMint.terms = c("A*M_cont1", "A*M_cont2"),
                 yreg = "linear", m_star = c(0,0), mreg = c("linear","linear"), nboot = 500)
```

#### Simulation-based Approach

```{r}
causal_mediation(data = df_mulipleM_EMint, model = "rb", est.method = "simulation",
                 outcome = "contY_2contM_EMint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), covariates = "C",
                 EMint = TRUE, EMint.terms = c("A*M_cont1", "A*M_cont2"),
                 yreg = "linear", m_star = c(0,0), mreg = c("linear","linear"), nsims = 500)[1:2]
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_mulipleM_EMint, model = "wb",
                 outcome = "contY_2contM_EMint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), covariates = "C",
                 EMint = TRUE, EMint.terms = c("A*M_cont1", "A*M_cont2"),
                 yreg = "linear", m_star = c(0,0), nboot = 500)
```

## Case 1-5: Continuous Outcome and Multiple Continuous Mediators With Mediator-mediator Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the first mediator M1 from $N((\beta_{01}+\beta_{11}*A+\beta_{21}*C),\sigma_{M1}^2)$ and the second mediator M2 from $N((\beta_{02}+\beta_{12}*A+\beta_{22}*C),\sigma_{M2}^2)$.

4. Simulate the outcome Y from $N(\theta_0+\theta_1A+\theta_2M1+\theta_3M2+\theta_4M1M2+\theta_5C,\sigma_Y^2)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_3$ & $\theta_4$ & $\theta_5$ & $\beta_{01}$ & $\beta_{11}$ & $\beta_{21}$ \\ \hline
10000&-5&0.8&1.8&1.2&0.6&0.1&-0.25&0.5&0.2 \\ \hline
$\beta_{02}$ & $\beta_{12}$ & $\beta_{22}$ & P(A=1) & $\mu_C$ & $\sigma_C$ & $\sigma_{M1}$ & $\sigma_{M2}$ & $\sigma_Y$\\ \hline
-0.3&0.4&0.3&0.4&1&1&0.1&0.1&0.2 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the first mediator:
$$E[M1|a,c]=\beta_{01}+\beta_{11}a+\beta_{21}c$$

True model for the second mediator:
$$E[M2|a,c]=\beta_{02}+\beta_{12}a+\beta_{22}c$$

True model for the outcome:
$$E[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m1^*+\theta_3m2^*+\theta_4m1^*m2^*+\theta_5c$$

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_mulipleM_MMint, model = "ne",
                 outcome = "contY_2contM_MMint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), MMint = TRUE, MMint.terms = c("M_cont1*M_cont2"),
                 covariates = "C", yreg = "linear")
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_mulipleM_MMint, model = "wb",
                 outcome = "contY_2contM_MMint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), covariates = "C",
                 MMint = TRUE, MMint.terms = c("M_cont1*M_cont2"),
                 yreg = "linear", m_star = c(0,0), nboot = 500)
```

## Case 1-6: Continuous Outcome and Multiple Continuous Mediators With Exposure-mediator-mediator Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the first mediator M1 from $N((\beta_{01}+\beta_{11}*A+\beta_{21}*C),\sigma_{M1}^2)$ and the second mediator M2 from $N((\beta_{02}+\beta_{12}*A+\beta_{22}*C),\sigma_{M2}^2)$.

4. Simulate the outcome Y from $N(\theta_0+\theta_1A+\theta_2M1+\theta_3M2+\theta_4AM1+\theta_5AM2+\theta_6M1M2+\theta_7AM1M2+\theta_8C,\sigma_Y^2)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_3$ & $\theta_4$ & $\theta_5$ & $\theta_6$ & $\theta_7$ & $\theta_8$ &$\beta_{01}$ \\ \hline
10000&-5&0.8&1.8&1.2&0.6&0.4&0.3&0.5&0.1&-0.25 \\ \hline
$\beta_{11}$ & $\beta_{21}$ & $\beta_{02}$ & $\beta_{12}$ & $\beta_{22}$ & P(A=1) & $\mu_C$ & $\sigma_C$ & $\sigma_{M1}$ & $\sigma_{M2}$ & $\sigma_Y$\\ \hline
0.5&0.2&-0.3&0.4&0.3&0.4&1&1&0.1&0.1&0.2 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the first mediator:
$$E[M1|a,c]=\beta_{01}+\beta_{11}a+\beta_{21}c$$

True model for the second mediator:
$$E[M2|a,c]=\beta_{02}+\beta_{12}a+\beta_{22}c$$

True model for the outcome:
$$E[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m1^*+\theta_3m2^*+\theta_4am1^*+\theta_5am2^*+\theta_6m1^*m2^*+\theta_7am1^*m2^*+\theta_8c$$

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_mulipleM_mint, model = "ne",
                 outcome = "contY_2contM_mint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), 
                 EMMint = TRUE, EMMint.terms = c("A*M_cont1*M_cont2"),
                 covariates = "C", yreg = "linear")
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_mulipleM_mint, model = "wb",
                 outcome = "contY_2contM_mint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), covariates = "C",
                 EMMint = TRUE, EMMint.terms = c("A*M_cont1*M_cont2"),
                 yreg = "linear", m_star = c(0,0), nboot = 500)
```


# Case 2: Continuous Outcome and Binary Mediator

## Case 2-1: Continuous Outcome and Single Binary Mediator Without Exposure-mediator Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the mediator M from $Bernoulli(expit(\beta_0+\beta_1*A+\beta_2*C))$.

4. Simulate the outcome Y from $N(\theta_0+\theta_1A+\theta_2M+\theta_4C,\sigma_Y^2)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_4$ & $\beta_0$ & $\beta_1$ & $\beta_2$ & P(A=1) & $\mu_C$ & $\sigma_C$ &  $\sigma_Y$\\ \hline
10000&-5&0.8&1.8&0.1&-0.25&0.5&0.2&0.4&1&1&0.2 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the mediator:
$$logitE[M|a,c]=\beta_0+\beta_1a+\beta_2c$$

True model for the outcome:
$$E[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m^*+\theta_4c$$

### Causal Effects and Standard Errors Estimated By the Structural Equation Model with 3 Different Estimation Method

#### Delta Method

```{r}
causal_mediation(data = df_noint, model = "standard", est.method = "delta", 
                 outcome = "contY_binM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = FALSE,
                 yreg = "linear", mreg = "logistic")
```

#### Bootstrapping

```{r}
causal_mediation(data = df_noint, model = "standard", est.method = "bootstrap", 
                 outcome = "contY_binM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = FALSE,
                 yreg = "linear", mreg = "logistic", nboot = 500)
```

#### Simulation-based Approach

```{r}
causal_mediation(data = df_noint, model = "standard", est.method = "simulation", 
                 outcome = "contY_binM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = FALSE,
                 yreg = "linear", mreg = "logistic",nsims = 500)[1:2]
```

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_noint, model = "ne",
                 outcome = "contY_binM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = FALSE,
                 yreg = "linear")
```

### Causal Effects and Standard Errors Estimated By the regression-based approach 

#### Bootstrapping

```{r}
causal_mediation(data = df_noint, model = "rb", est.method = "bootstrap",
                 outcome = "contY_binM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = FALSE,
                 yreg = "linear", mreg = "logistic", nboot = 500)
```

#### Simulation-based Approach

```{r}
causal_mediation(data = df_noint, model = "rb", est.method = "simulation",
                 outcome = "contY_binM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = FALSE,
                 yreg = "linear", mreg = "logistic", nsims = 500)[1:2]
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_noint, model = "wb",
                 outcome = "contY_binM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = FALSE,
                 yreg = "linear")
```

## Case 2-2: Continuous Outcome and Single Binary Mediator With Exposure-mediator Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the mediator M from $Bernoulli(expit(\beta_0+\beta_1*A+\beta_2*C))$.

4. Simulate the outcome Y from $N(\theta_0+\theta_1A+\theta_2M+\theta_3AM+\theta_4C,\sigma_Y^2)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_3$ & $\theta_4$ & $\beta_0$ & $\beta_1$ & $\beta_2$ & P(A=1) & $\mu_C$ & $\sigma_C$  & $\sigma_Y$\\ \hline
10000&-5&0.8&1.8&0.2&0.1&-0.25&0.5&0.2&0.4&1&1&0.2 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the mediator:
$$logitE[M|a,c]=\beta_0+\beta_1a+\beta_2c$$

True model for the outcome:
$$E[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m^*+\theta_3am^*+\theta_4c$$

### Causal Effects and Standard Errors Estimated By the Structural Equation Model with 3 Different Estimation Method

#### Delta Method

```{r}
causal_mediation(data = df_int, model = "standard", est.method = "delta", 
                 outcome = "contY_binM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = TRUE,
                 yreg = "linear", mreg = "logistic")
```

#### Bootstrapping

```{r}
causal_mediation(data = df_int, model = "standard", est.method = "bootstrap", 
                 outcome = "contY_binM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = TRUE,
                 yreg = "linear", mreg = "logistic", nboot = 500)
```

#### Simulation-based Approach

```{r}
causal_mediation(data = df_int, model = "standard", est.method = "simulation", 
                 outcome = "contY_binM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = TRUE,
                 yreg = "linear", mreg = "logistic",nsims = 500)[1:2]
```

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_int, model = "ne",
                 outcome = "contY_binM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = TRUE,
                 yreg = "linear")
```

### Causal Effects and Standard Errors Estimated By the regression-based approach

#### Bootstrapping

```{r}
causal_mediation(data = df_int, model = "rb", est.method = "bootstrap",
                 outcome = "contY_binM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = TRUE,
                 yreg = "linear", mreg = "logistic", nboot = 500)
```

#### Simulation-based Approach

```{r}
causal_mediation(data = df_int, model = "rb", est.method = "simulation",
                 outcome = "contY_binM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = TRUE,
                 yreg = "linear", mreg = "logistic", nsims = 500)[1:2]
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_int, model = "wb",
                 outcome = "contY_binM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = TRUE,
                 yreg = "linear", nboot = 500)
```

## Case 2-3: Continuous Outcome and Multiple Binary Mediators Without Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the first mediator M1 from $Bernoulli(expit(\beta_{01}+\beta_{11}*A+\beta_{21}*C))$ and the second mediator M2 from $Bernoulli(expit(\beta_{02}+\beta_{12}*A+\beta_{22}*C))$.

4. Simulate the outcome Y from $N(\theta_0+\theta_1A+\theta_2M1+\theta_3M2+\theta_4C,\sigma_Y^2)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_3$ & $\theta_4$ & $\beta_{01}$ & $\beta_{11}$ & $\beta_{21}$ \\ \hline
10000&-5&0.8&1.8&1.2&0.1&-0.25&0.5&0.2 \\ \hline
$\beta_{02}$ & $\beta_{12}$ & $\beta_{22}$ & P(A=1) & $\mu_C$ & $\sigma_C$ & $\sigma_{M1}$ & $\sigma_{M2}$ & $\sigma_Y$\\ \hline
-0.3&0.4&0.3&0.4&1&1&0.1&0.1&0.2 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the first mediator:
$$logitE[M1|a,c]=\beta_{01}+\beta_{11}a+\beta_{21}c$$

True model for the second mediator:
$$logitE[M2|a,c]=\beta_{02}+\beta_{12}a+\beta_{22}c$$

True model for the outcome:
$$E[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m1^*+\theta_3m2^*+\theta_4c$$

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_mulipleM_noint, model = "ne",
                 outcome = "contY_2binM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_bin1','M_bin2'), covariates = "C", 
                 yreg = "linear")
```

### Causal Effects and Standard Errors Estimated By the regression-based approach

#### Bootstrapping

```{r}
causal_mediation(data = df_mulipleM_noint, model = "rb", est.method = "bootstrap",
                 outcome = "contY_2binM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_bin1','M_bin2'), covariates = "C",
                 yreg = "linear", m_star = c(0,0), mreg = c("logistic","logistic"), nboot = 500)
```

#### Simulation-based Approach

```{r}
causal_mediation(data = df_mulipleM_noint, model = "rb", est.method = "simulation",
                 outcome = "contY_2binM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_bin1','M_bin2'), covariates = "C",
                 yreg = "linear", m_star = c(0,0), mreg = c("logistic","logistic"), nsims = 500)[1:2]
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_mulipleM_noint, model = "wb",
                 outcome = "contY_2binM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_bin1','M_bin2'), covariates = "C",
                 yreg = "linear", m_star = c(0,0), nboot = 500)
```

## Case 2-4: Continuous Outcome and Multiple Binary Mediators With Exposure-mediator Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the first mediator M1 from $Bernoulli(expit(\beta_{01}+\beta_{11}*A+\beta_{21}*C))$ and the second mediator M2 from $Bernoulli(expit(\beta_{02}+\beta_{12}*A+\beta_{22}*C))$.

4. Simulate the outcome Y from $N(\theta_0+\theta_1A+\theta_2M1+\theta_3M2+\theta_4AM1+\theta_5AM2+\theta_6C,\sigma_Y^2)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_3$ & $\theta_4$ & $\theta_5$ & $\theta_6$ & $\beta_{01}$ & $\beta_{11}$ \\ \hline
10000&-5&0.8&1.8&1.2&0.6&0.4&0.1&-0.25&0.5 \\ \hline
$\beta_{21}$ & $\beta_{02}$ & $\beta_{12}$ & $\beta_{22}$ & P(A=1) & $\mu_C$ & $\sigma_C$ & $\sigma_{M1}$ & $\sigma_{M2}$ & $\sigma_Y$\\ \hline
0.2&-0.3&0.4&0.3&0.4&1&1&0.1&0.1&0.2 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the first mediator:
$$logitE[M1|a,c]=\beta_{01}+\beta_{11}a+\beta_{21}c$$

True model for the second mediator:
$$logitE[M2|a,c]=\beta_{02}+\beta_{12}a+\beta_{22}c$$

True model for the outcome:
$$E[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m1^*+\theta_3m2^*+\theta_4am1^*+\theta_5am2^*+\theta_6c$$

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_mulipleM_EMint, model = "ne",
                 outcome = "contY_2binM_EMint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_bin1','M_bin2'), EMint = TRUE, EMint.terms = c("A*M_bin1", "A*M_bin2"),
                 covariates = "C", yreg = "linear")
```

### Causal Effects and Standard Errors Estimated By the regression-based approach

#### Bootstrapping

```{r}
causal_mediation(data = df_mulipleM_EMint, model = "rb", est.method = "bootstrap",
                 outcome = "contY_2binM_EMint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_bin1','M_bin2'), covariates = "C",
                 EMint = TRUE, EMint.terms = c("A*M_bin1", "A*M_bin2"),
                 yreg = "linear", m_star = c(0,0), mreg = c("logistic","logistic"), nboot = 500)
```

#### Simulation-based Approach

```{r}
causal_mediation(data = df_mulipleM_EMint, model = "rb", est.method = "simulation",
                 outcome = "contY_2binM_EMint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_bin1','M_bin2'), covariates = "C",
                 EMint = TRUE, EMint.terms = c("A*M_bin1", "A*M_bin2"),
                 yreg = "linear", m_star = c(0,0), mreg = c("logistic","logistic"), nsims = 500)[1:2]
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_mulipleM_EMint, model = "wb",
                 outcome = "contY_2binM_EMint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_bin1','M_bin2'), covariates = "C",
                 EMint = TRUE, EMint.terms = c("A*M_bin1", "A*M_bin2"),
                 yreg = "linear", m_star = c(0,0), nboot = 500)
```

## Case 2-5: Continuous Outcome and Multiple Binary Mediators With Mediator-mediator Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the first mediator M1 from $Bernoulli(expit(\beta_{01}+\beta_{11}*A+\beta_{21}*C))$ and the second mediator M2 from $Bernoulli(expit(\beta_{02}+\beta_{12}*A+\beta_{22}*C))$.

4. Simulate the outcome Y from $N(\theta_0+\theta_1A+\theta_2M1+\theta_3M2+\theta_4M1M2+\theta_5C,\sigma_Y^2)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_3$ & $\theta_4$ & $\theta_5$ & $\beta_{01}$ & $\beta_{11}$ & $\beta_{21}$ \\ \hline
10000&-5&0.8&1.8&1.2&0.6&0.1&-0.25&0.5&0.2 \\ \hline
$\beta_{02}$ & $\beta_{12}$ & $\beta_{22}$ & P(A=1) & $\mu_C$ & $\sigma_C$ & $\sigma_{M1}$ & $\sigma_{M2}$ & $\sigma_Y$\\ \hline
-0.3&0.4&0.3&0.4&1&1&0.1&0.1&0.2 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the first mediator:
$$logitE[M1|a,c]=\beta_{01}+\beta_{11}a+\beta_{21}c$$

True model for the second mediator:
$$logitE[M2|a,c]=\beta_{02}+\beta_{12}a+\beta_{22}c$$

True model for the outcome:
$$E[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m1^*+\theta_3m2^*+\theta_4m1^*m2^*+\theta_5c$$

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_mulipleM_MMint, model = "ne",
                 outcome = "contY_2binM_MMint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_bin1','M_bin2'), MMint = TRUE, MMint.terms = c("M_bin1*M_bin2"),
                 covariates = "C", yreg = "linear")
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_mulipleM_MMint, model = "wb",
                 outcome = "contY_2binM_MMint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_bin1','M_bin2'), covariates = "C",
                 MMint = TRUE, MMint.terms = c("M_bin1*M_bin2"),
                 yreg = "linear", m_star = c(0,0), nboot = 500)
```

## Case 2-6: Continuous Outcome and Multiple Binary Mediators With Exposure-mediator-mediator Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the first mediator M1 from $Bernoulli(expit(\beta_{01}+\beta_{11}*A+\beta_{21}*C))$ and the second mediator M2 from $Bernoulli(expit(\beta_{02}+\beta_{12}*A+\beta_{22}*C))$.

4. Simulate the outcome Y from $N(\theta_0+\theta_1A+\theta_2M1+\theta_3M2+\theta_4AM1+\theta_5AM2+\theta_6M1M2+\theta_7AM1M2+\theta_8C,\sigma_Y^2)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_3$ & $\theta_4$ & $\theta_5$ & $\theta_6$ & $\theta_7$ & $\theta_8$ &$\beta_{01}$ \\ \hline
10000&-5&0.8&1.8&1.2&0.6&0.4&0.3&0.5&0.1&-0.25 \\ \hline
$\beta_{11}$ & $\beta_{21}$ & $\beta_{02}$ & $\beta_{12}$ & $\beta_{22}$ & P(A=1) & $\mu_C$ & $\sigma_C$ & $\sigma_{M1}$ & $\sigma_{M2}$ & $\sigma_Y$\\ \hline
0.5&0.2&-0.3&0.4&0.3&0.4&1&1&0.1&0.1&0.2 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the first mediator:
$$logitE[M1|a,c]=\beta_{01}+\beta_{11}a+\beta_{21}c$$

True model for the second mediator:
$$logitE[M2|a,c]=\beta_{02}+\beta_{12}a+\beta_{22}c$$

True model for the outcome:
$$E[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m1^*+\theta_3m2^*+\theta_4am1^*+\theta_5am2^*+\theta_6m1^*m2^*+\theta_7am1^*m2^*+\theta_8c$$

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_mulipleM_mint, model = "ne",
                 outcome = "contY_2binM_mint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_bin1','M_bin2'), 
                 EMMint = TRUE, EMMint.terms = c("A*M_bin1*M_bin2"),
                 covariates = "C", yreg = "linear")
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_mulipleM_mint, model = "wb",
                 outcome = "contY_2binM_mint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_bin1','M_bin2'), covariates = "C",
                 EMMint = TRUE, EMMint.terms = c("A*M_bin1*M_bin2"),
                 yreg = "linear", m_star = c(0,0), nboot = 500)
```

# Case 3: Binary Outcome and Continuous Mediator

## Case 3-1: Binary Outcome and Single Continuous Mediator Without Exposure-mediator Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the mediator M from $N((\beta_0+\beta_1*A+\beta_2*C),\sigma_M^2)$.

4. Simulate the outcome Y from $Bernoulli(\theta_0+\theta_1A+\theta_2M+\theta_4C)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_4$ & $\beta_0$ & $\beta_1$ & $\beta_2$ & P(A=1) & $\mu_C$ & $\sigma_C$ & $\sigma_M$\\ \hline
10000&-5&0.8&1.8&0.1&-0.25&0.5&0.2&0.4&1&1&0.1 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the mediator:
$$E[M|a,c]=\beta_0+\beta_1a+\beta_2c$$

True model for the outcome:
$$logitE[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m^*+\theta_4c$$

### Causal Effects and Standard Errors Estimated By the Structural Equation Model with 3 Different Estimation Method

#### Delta Method

```{r}
causal_mediation(data = df_noint, model = "standard", est.method = "delta", 
                 outcome = "binY_contM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = FALSE,
                 yreg = "logistic", mreg = "linear")
```

#### Bootstrapping

```{r}
causal_mediation(data = df_noint, model = "standard", est.method = "bootstrap", 
                 outcome = "binY_contM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = FALSE,
                 yreg = "logistic", mreg = "linear", nboot = 500)
```

#### Simulation-based Approach

```{r}
causal_mediation(data = df_noint, model = "standard", est.method = "simulation", 
                 outcome = "binY_contM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = FALSE,
                 yreg = "logistic", mreg = "linear",nsims = 500)[1:2]
```

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_noint, model = "ne",
                 outcome = "binY_contM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = FALSE,
                 yreg = "logistic")
```

### Causal Effects and Standard Errors Estimated By the regression-based approach 

#### Bootstrapping

```{r}
causal_mediation(data = df_noint, model = "rb", est.method = "bootstrap",
                 outcome = "binY_contM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = FALSE,
                 yreg = "logistic", mreg = "linear", nboot = 500)
```

#### Simulation-based Approach

```{r}
causal_mediation(data = df_noint, model = "rb", est.method = "simulation",
                 outcome = "binY_contM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = FALSE,
                 yreg = "logistic", mreg = "linear", nsims = 500)[1:2]
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_noint, model = "wb",
                 outcome = "binY_contM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = FALSE,
                 yreg = "logistic")
```

## Case 3-2: Binary Outcome and Single Continuous Mediator With Exposure-mediator Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the mediator M from $N((\beta_0+\beta_1*A+\beta_2*C),\sigma_M^2)$.

4. Simulate the outcome Y from $Bernoulli(\theta_0+\theta_1A+\theta_2M+\theta_3AM+\theta_4C)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_3$ & $\theta_4$ & $\beta_0$ & $\beta_1$ & $\beta_2$ & P(A=1) & $\mu_C$ & $\sigma_C$ & $\sigma_M$ \\ \hline
10000&-5&0.8&1.8&0.2&0.1&-0.25&0.5&0.2&0.4&1&1&0.1 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the mediator:
$$E[M|a,c]=\beta_0+\beta_1a+\beta_2c$$

True model for the outcome:
$$logitE[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m^*+\theta_3am^*+\theta_4c$$

### Causal Effects and Standard Errors Estimated By the Structural Equation Model with 3 Different Estimation Method

#### Delta Method

```{r}
causal_mediation(data = df_int, model = "standard", est.method = "delta", 
                 outcome = "binY_contM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = TRUE,
                 yreg = "logistic", mreg = "linear")
```

#### Bootstrapping

```{r}
causal_mediation(data = df_int, model = "standard", est.method = "bootstrap", 
                 outcome = "binY_contM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = TRUE,
                 yreg = "logistic", mreg = "linear", nboot = 500)
```

#### Simulation-based Approach

```{r}
causal_mediation(data = df_int, model = "standard", est.method = "simulation", 
                 outcome = "binY_contM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = TRUE,
                 yreg = "logistic", mreg = "linear",nsims = 500)[1:2]
```

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_int, model = "ne",
                 outcome = "binY_contM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = TRUE,
                 yreg = "logistic")
```

### Causal Effects and Standard Errors Estimated By the regression-based approach

#### Bootstrapping

```{r}
causal_mediation(data = df_int, model = "rb", est.method = "bootstrap",
                 outcome = "binY_contM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = TRUE,
                 yreg = "logistic", mreg = "linear", nboot = 500)
```

#### Simulation-based Approach

```{r}
causal_mediation(data = df_int, model = "rb", est.method = "simulation",
                 outcome = "binY_contM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = TRUE,
                 yreg = "logistic", mreg = "linear", nsims = 500)[1:2]
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_int, model = "wb",
                 outcome = "binY_contM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_cont', covariates = "C", EMint = TRUE,
                 yreg = "logistic", nboot = 500)
```

## Case 3-3: Binary Outcome and Multiple Continuous Mediators Without Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the first mediator M1 from $N((\beta_{01}+\beta_{11}*A+\beta_{21}*C),\sigma_{M1}^2)$ and the second mediator M2 from $N((\beta_{02}+\beta_{12}*A+\beta_{22}*C),\sigma_{M2}^2)$.

4. Simulate the outcome Y from $Bernoulli(\theta_0+\theta_1A+\theta_2M1+\theta_3M2+\theta_4C)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_3$ & $\theta_4$ & $\beta_{01}$ & $\beta_{11}$ & $\beta_{21}$ \\ \hline
10000&-5&0.8&1.8&1.2&0.1&-0.25&0.5&0.2 \\ \hline
$\beta_{02}$ & $\beta_{12}$ & $\beta_{22}$ & P(A=1) & $\mu_C$ & $\sigma_C$ & $\sigma_{M1}$ & $\sigma_{M2}$\\ \hline
-0.3&0.4&0.3&0.4&1&1&0.1&0.1 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the first mediator:
$$E[M1|a,c]=\beta_{01}+\beta_{11}a+\beta_{21}c$$

True model for the second mediator:
$$E[M2|a,c]=\beta_{02}+\beta_{12}a+\beta_{22}c$$

True model for the outcome:
$$logitE[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m1^*+\theta_3m2^*+\theta_4c$$

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_mulipleM_noint, model = "ne",
                 outcome = "binY_2contM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), covariates = "C", 
                 yreg = "logistic")
```

### Causal Effects and Standard Errors Estimated By the regression-based approach

#### Bootstrapping

```{r}
causal_mediation(data = df_mulipleM_noint, model = "rb", est.method = "bootstrap",
                 outcome = "binY_2contM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), covariates = "C",
                 yreg = "logistic", m_star = c(0,0), mreg = c("linear","linear"), nboot = 500)
```

#### Simulation-based Approach

```{r}
causal_mediation(data = df_mulipleM_noint, model = "rb", est.method = "simulation",
                 outcome = "binY_2contM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), covariates = "C",
                 yreg = "logistic", m_star = c(0,0), mreg = c("linear","linear"), nsims = 500)[1:2]
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_mulipleM_noint, model = "wb",
                 outcome = "binY_2contM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), covariates = "C",
                 yreg = "logistic", m_star = c(0,0), nboot = 500)
```

## Case 3-4: Binary Outcome and Multiple Continuous Mediators With Exposure-mediator Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the first mediator M1 from $N((\beta_{01}+\beta_{11}*A+\beta_{21}*C),\sigma_{M1}^2)$ and the second mediator M2 from $N((\beta_{02}+\beta_{12}*A+\beta_{22}*C),\sigma_{M2}^2)$.

4. Simulate the outcome Y from $Bernoulli(\theta_0+\theta_1A+\theta_2M1+\theta_3M2+\theta_4AM1+\theta_5AM2+\theta_6C)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_3$ & $\theta_4$ & $\theta_5$ & $\theta_6$ & $\beta_{01}$ & $\beta_{11}$ \\ \hline
10000&-5&0.8&1.8&1.2&0.6&0.4&0.1&-0.25&0.5 \\ \hline
$\beta_{21}$ & $\beta_{02}$ & $\beta_{12}$ & $\beta_{22}$ & P(A=1) & $\mu_C$ & $\sigma_C$ & $\sigma_{M1}$ & $\sigma_{M2}$ \\ \hline
0.2&-0.3&0.4&0.3&0.4&1&1&0.1&0.1 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the first mediator:
$$E[M1|a,c]=\beta_{01}+\beta_{11}a+\beta_{21}c$$

True model for the second mediator:
$$E[M2|a,c]=\beta_{02}+\beta_{12}a+\beta_{22}c$$

True model for the outcome:
$$logitE[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m1^*+\theta_3m2^*+\theta_4am1^*+\theta_5am2^*+\theta_6c$$

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_mulipleM_EMint, model = "ne",
                 outcome = "binY_2contM_EMint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), EMint = TRUE, EMint.terms = c("A*M_cont1", "A*M_cont2"),
                 covariates = "C", yreg = "logistic")
```

### Causal Effects and Standard Errors Estimated By the regression-based approach

#### Bootstrapping

```{r}
causal_mediation(data = df_mulipleM_EMint, model = "rb", est.method = "bootstrap",
                 outcome = "binY_2contM_EMint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), covariates = "C",
                 EMint = TRUE, EMint.terms = c("A*M_cont1", "A*M_cont2"),
                 yreg = "logistic", m_star = c(0,0), mreg = c("linear","linear"), nboot = 500)
```

#### Simulation-based Approach

```{r}
causal_mediation(data = df_mulipleM_EMint, model = "rb", est.method = "simulation",
                 outcome = "binY_2contM_EMint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), covariates = "C",
                 EMint = TRUE, EMint.terms = c("A*M_cont1", "A*M_cont2"),
                 yreg = "logistic", m_star = c(0,0), mreg = c("linear","linear"), nsims = 500)[1:2]
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_mulipleM_EMint, model = "wb",
                 outcome = "binY_2contM_EMint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), covariates = "C",
                 EMint = TRUE, EMint.terms = c("A*M_cont1", "A*M_cont2"),
                 yreg = "logistic", m_star = c(0,0), nboot = 500)
```

## Case 3-5: Binary Outcome and Multiple Continuous Mediators With Mediator-mediator Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the first mediator M1 from $N((\beta_{01}+\beta_{11}*A+\beta_{21}*C),\sigma_{M1}^2)$ and the second mediator M2 from $N((\beta_{02}+\beta_{12}*A+\beta_{22}*C),\sigma_{M2}^2)$.

4. Simulate the outcome Y from $Bernoulli(\theta_0+\theta_1A+\theta_2M1+\theta_3M2+\theta_4M1M2+\theta_5C)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_3$ & $\theta_4$ & $\theta_5$ & $\beta_{01}$ & $\beta_{11}$ & $\beta_{21}$ \\ \hline
10000&-5&0.8&1.8&1.2&0.6&0.1&-0.25&0.5&0.2 \\ \hline
$\beta_{02}$ & $\beta_{12}$ & $\beta_{22}$ & P(A=1) & $\mu_C$ & $\sigma_C$ & $\sigma_{M1}$ & $\sigma_{M2}$ \\ \hline
-0.3&0.4&0.3&0.4&1&1&0.1&0.1 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the first mediator:
$$E[M1|a,c]=\beta_{01}+\beta_{11}a+\beta_{21}c$$

True model for the second mediator:
$$E[M2|a,c]=\beta_{02}+\beta_{12}a+\beta_{22}c$$

True model for the outcome:
$$logitE[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m1^*+\theta_3m2^*+\theta_4m1^*m2^*+\theta_5c$$

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_mulipleM_MMint, model = "ne",
                 outcome = "binY_2contM_MMint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), MMint = TRUE, MMint.terms = c("M_cont1*M_cont2"),
                 covariates = "C", yreg = "logistic")
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_mulipleM_MMint, model = "wb",
                 outcome = "binY_2contM_MMint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), covariates = "C",
                 MMint = TRUE, MMint.terms = c("M_cont1*M_cont2"),
                 yreg = "logistic", m_star = c(0,0), nboot = 500)
```

## Case 3-6: Binary Outcome and Multiple Continuous Mediators With Exposure-mediator-mediator Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the first mediator M1 from $N((\beta_{01}+\beta_{11}*A+\beta_{21}*C),\sigma_{M1}^2)$ and the second mediator M2 from $N((\beta_{02}+\beta_{12}*A+\beta_{22}*C),\sigma_{M2}^2)$.

4. Simulate the outcome Y from $Bernoulli(\theta_0+\theta_1A+\theta_2M1+\theta_3M2+\theta_4AM1+\theta_5AM2+\theta_6M1M2+\theta_7AM1M2+\theta_8C)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_3$ & $\theta_4$ & $\theta_5$ & $\theta_6$ & $\theta_7$ & $\theta_8$ &$\beta_{01}$ \\ \hline
10000&-5&0.8&1.8&1.2&0.6&0.4&0.3&0.5&0.1&-0.25 \\ \hline
$\beta_{11}$ & $\beta_{21}$ & $\beta_{02}$ & $\beta_{12}$ & $\beta_{22}$ & P(A=1) & $\mu_C$ & $\sigma_C$ & $\sigma_{M1}$ & $\sigma_{M2}$ \\ \hline
0.5&0.2&-0.3&0.4&0.3&0.4&1&1&0.1&0.1 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the first mediator:
$$E[M1|a,c]=\beta_{01}+\beta_{11}a+\beta_{21}c$$

True model for the second mediator:
$$E[M2|a,c]=\beta_{02}+\beta_{12}a+\beta_{22}c$$

True model for the outcome:
$$logitE[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m1^*+\theta_3m2^*+\theta_4am1^*+\theta_5am2^*+\theta_6m1^*m2^*+\theta_7am1^*m2^*+\theta_8c$$

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_mulipleM_mint, model = "ne",
                 outcome = "binY_2contM_mint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), 
                 EMMint = TRUE, EMMint.terms = c("A*M_cont1*M_cont2"),
                 covariates = "C", yreg = "logistic")
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_mulipleM_mint, model = "wb",
                 outcome = "binY_2contM_mint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_cont1','M_cont2'), covariates = "C",
                 EMMint = TRUE, EMMint.terms = c("A*M_cont1*M_cont2"),
                 yreg = "logistic", m_star = c(0,0), nboot = 500)
```


# Case 4: Binary Outcome and Binary Mediator

## Case 4-1: Binary Outcome and Single Binary Mediator Without Exposure-mediator Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the mediator M from $Bernoulli(\beta_0+\beta_1*A+\beta_2*C)$.

4. Simulate the outcome Y from $Bernoulli(\theta_0+\theta_1A+\theta_2M+\theta_4C)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_4$ & $\beta_0$ & $\beta_1$ & $\beta_2$ & P(A=1) & $\mu_C$ & $\sigma_C$\\ \hline
10000&-5&0.8&1.8&0.1&-0.25&0.5&0.2&0.4&1&1 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the mediator:
$$logitE[M|a,c]=\beta_0+\beta_1a+\beta_2c$$

True model for the outcome:
$$logitE[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m^*+\theta_4c$$

### Causal Effects and Standard Errors Estimated By the Structural Equation Model with 3 Different Estimation Method

#### Delta Method

```{r}
causal_mediation(data = df_noint, model = "standard", est.method = "delta", 
                 outcome = "binY_binM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = FALSE,
                 yreg = "logistic", mreg = "logistic")
```

#### Bootstrapping

```{r}
causal_mediation(data = df_noint, model = "standard", est.method = "bootstrap", 
                 outcome = "binY_binM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = FALSE,
                 yreg = "logistic", mreg = "logistic", nboot = 500)
```

#### Simulation-based Approach

```{r}
causal_mediation(data = df_noint, model = "standard", est.method = "simulation", 
                 outcome = "binY_binM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = FALSE,
                 yreg = "logistic", mreg = "logistic",nsims = 500)[1:2]
```

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_noint, model = "ne",
                 outcome = "binY_binM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = FALSE,
                 yreg = "logistic")
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_noint, model = "wb",
                 outcome = "binY_binM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = FALSE,
                 yreg = "logistic")
```

## Case 3-2: Binary Outcome and Single Continuous Mediator With Exposure-mediator Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the mediator M from $Bernoulli(\beta_0+\beta_1*A+\beta_2*C)$.

4. Simulate the outcome Y from $Bernoulli(\theta_0+\theta_1A+\theta_2M+\theta_3AM+\theta_4C)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_3$ & $\theta_4$ & $\beta_0$ & $\beta_1$ & $\beta_2$ & P(A=1) & $\mu_C$ & $\sigma_C$  \\ \hline
10000&-5&0.8&1.8&0.2&0.1&-0.25&0.5&0.2&0.4&1&1 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the mediator:
$$logitE[M|a,c]=\beta_0+\beta_1a+\beta_2c$$

True model for the outcome:
$$logitE[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m^*+\theta_3am^*+\theta_4c$$

### Causal Effects and Standard Errors Estimated By the Structural Equation Model with 3 Different Estimation Method

#### Delta Method

```{r}
causal_mediation(data = df_int, model = "standard", est.method = "delta", 
                 outcome = "binY_binM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = TRUE,
                 yreg = "logistic", mreg = "logistic")
```

#### Bootstrapping

```{r}
causal_mediation(data = df_int, model = "standard", est.method = "bootstrap", 
                 outcome = "binY_binM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = TRUE,
                 yreg = "logistic", mreg = "logistic", nboot = 500)
```

#### Simulation-based Approach

```{r}
causal_mediation(data = df_int, model = "standard", est.method = "simulation", 
                 outcome = "binY_binM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = TRUE,
                 yreg = "logistic", mreg = "logistic",nsims = 500)[1:2]
```

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_int, model = "ne",
                 outcome = "binY_binM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = TRUE,
                 yreg = "logistic")
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_int, model = "wb",
                 outcome = "binY_binM_int", exposure = 'A', exposure.type = "binary",
                 mediator = 'M_bin', covariates = "C", EMint = TRUE,
                 yreg = "logistic", nboot = 500)
```

## Case 4-3: Binary Outcome and Multiple Binary Mediators Without Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the first mediator M1 from $Bernoulli(\beta_{01}+\beta_{11}*A+\beta_{21}*C)$ and the second mediator M2 from $Bernoulli(\beta_{02}+\beta_{12}*A+\beta_{22}*C)$.

4. Simulate the outcome Y from $Bernoulli(\theta_0+\theta_1A+\theta_2M1+\theta_3M2+\theta_4C)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_3$ & $\theta_4$ & $\beta_{01}$ & $\beta_{11}$ & $\beta_{21}$ \\ \hline
10000&-5&0.8&1.8&1.2&0.1&-0.25&0.5&0.2 \\ \hline
$\beta_{02}$ & $\beta_{12}$ & $\beta_{22}$ & P(A=1) & $\mu_C$ & $\sigma_C$ \\ \hline
-0.3&0.4&0.3&0.4&1&1 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the first mediator:
$$logitE[M1|a,c]=\beta_{01}+\beta_{11}a+\beta_{21}c$$

True model for the second mediator:
$$logitE[M2|a,c]=\beta_{02}+\beta_{12}a+\beta_{22}c$$

True model for the outcome:
$$logitE[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m1^*+\theta_3m2^*+\theta_4c$$

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_mulipleM_noint, model = "ne",
                 outcome = "binY_2binM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_bin1','M_bin2'), covariates = "C", 
                 yreg = "logistic")
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_mulipleM_noint, model = "wb",
                 outcome = "binY_2binM_noint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_bin1','M_bin2'), covariates = "C",
                 yreg = "logistic", m_star = c(0,0), nboot = 500)
```

## Case 4-4: Binary Outcome and Multiple Binary Mediators With Exposure-mediator Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the first mediator M1 from $Bernoulli(\beta_{01}+\beta_{11}*A+\beta_{21}*C)$ and the second mediator M2 from $Bernoulli(\beta_{02}+\beta_{12}*A+\beta_{22}*C)$.

4. Simulate the outcome Y from $Bernoulli(\theta_0+\theta_1A+\theta_2M1+\theta_3M2+\theta_4AM1+\theta_5AM2+\theta_6C)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_3$ & $\theta_4$ & $\theta_5$ & $\theta_6$ & $\beta_{01}$ & $\beta_{11}$ \\ \hline
10000&-5&0.8&1.8&1.2&0.6&0.4&0.1&-0.25&0.5 \\ \hline
$\beta_{21}$ & $\beta_{02}$ & $\beta_{12}$ & $\beta_{22}$ & P(A=1) & $\mu_C$ & $\sigma_C$ \\ \hline
0.2&-0.3&0.4&0.3&0.4&1&1 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the first mediator:
$$logitE[M1|a,c]=\beta_{01}+\beta_{11}a+\beta_{21}c$$

True model for the second mediator:
$$logitE[M2|a,c]=\beta_{02}+\beta_{12}a+\beta_{22}c$$

True model for the outcome:
$$logitE[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m1^*+\theta_3m2^*+\theta_4am1^*+\theta_5am2^*+\theta_6c$$

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_mulipleM_EMint, model = "ne",
                 outcome = "binY_2binM_EMint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_bin1','M_bin2'), EMint = TRUE, EMint.terms = c("A*M_bin1", "A*M_bin2"),
                 covariates = "C", yreg = "logistic")
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_mulipleM_EMint, model = "wb",
                 outcome = "binY_2binM_EMint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_bin1','M_bin2'), covariates = "C",
                 EMint = TRUE, EMint.terms = c("A*M_bin1", "A*M_bin2"),
                 yreg = "logistic", m_star = c(0,0), nboot = 500)
```

## Case 4-5: Binary Outcome and Multiple Binary Mediators With Mediator-mediator Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the first mediator M1 from $Bernoulli(\beta_{01}+\beta_{11}*A+\beta_{21}*C)$ and the second mediator M2 from $Bernoulli(\beta_{02}+\beta_{12}*A+\beta_{22}*C)$.

4. Simulate the outcome Y from $Bernoulli(\theta_0+\theta_1A+\theta_2M1+\theta_3M2+\theta_4M1M2+\theta_5C)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_3$ & $\theta_4$ & $\theta_5$ & $\beta_{01}$ & $\beta_{11}$ & $\beta_{21}$ \\ \hline
10000&-5&0.8&1.8&1.2&0.6&0.1&-0.25&0.5&0.2 \\ \hline
$\beta_{02}$ & $\beta_{12}$ & $\beta_{22}$ & P(A=1) & $\mu_C$ & $\sigma_C$ \\ \hline
-0.3&0.4&0.3&0.4&1&1 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the first mediator:
$$logitE[M1|a,c]=\beta_{01}+\beta_{11}a+\beta_{21}c$$

True model for the second mediator:
$$logitE[M2|a,c]=\beta_{02}+\beta_{12}a+\beta_{22}c$$

True model for the outcome:
$$logitE[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m1^*+\theta_3m2^*+\theta_4m1^*m2^*+\theta_5c$$

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_mulipleM_MMint, model = "ne",
                 outcome = "binY_2binM_MMint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_bin1','M_bin2'), MMint = TRUE, MMint.terms = c("M_bin1*M_bin2"),
                 covariates = "C", yreg = "logistic")
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_mulipleM_MMint, model = "wb",
                 outcome = "binY_2binM_MMint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_bin1','M_bin2'), covariates = "C",
                 MMint = TRUE, MMint.terms = c("M_bin1*M_bin2"),
                 yreg = "logistic", m_star = c(0,0), nboot = 500)
```

## Case 4-6: Binary Outcome and Multiple Binary Mediators With Exposure-mediator-mediator Interaction

### Data simulation

#### Simulation Procedures

1. Simulate the exposure variable A from Binom(1,P(A=1)).

2. Simulate the covariate C from $N(\mu_C,\sigma_C^2)$.

3. Simulate the first mediator M1 from $Bernoulli(\beta_{01}+\beta_{11}*A+\beta_{21}*C)$ and the second mediator M2 from $Bernoulli(\beta_{02}+\beta_{12}*A+\beta_{22}*C)$.

4. Simulate the outcome Y from $Bernoulli(\theta_0+\theta_1A+\theta_2M1+\theta_3M2+\theta_4AM1+\theta_5AM2+\theta_6M1M2+\theta_7AM1M2+\theta_8C)$.

#### True Parameters

\begin{center}
\captionof{table}{True Model Parameters for Data Simulation}
\begin{tabular}{l|l|l|l|l|l|l|l|l|l|l}
\hline
Sample Size & $\theta_0$ & $\theta_1$ & $\theta_2$ & $\theta_3$ & $\theta_4$ & $\theta_5$ & $\theta_6$ & $\theta_7$ & $\theta_8$ &$\beta_{01}$ \\ \hline
10000&-5&0.8&1.8&1.2&0.6&0.4&0.3&0.5&0.1&-0.25 \\ \hline
$\beta_{11}$ & $\beta_{21}$ & $\beta_{02}$ & $\beta_{12}$ & $\beta_{22}$ & P(A=1) & $\mu_C$ & $\sigma_C$ & $\sigma_{M1}$ & $\sigma_{M2}$ \\ \hline
0.5&0.2&-0.3&0.4&0.3&0.4&1&1&0.1&0.1 \\ \hline
\end{tabular}
\end{center}

#### True Models

True model for the first mediator:
$$logitE[M1|a,c]=\beta_{01}+\beta_{11}a+\beta_{21}c$$

True model for the second mediator:
$$logitE[M2|a,c]=\beta_{02}+\beta_{12}a+\beta_{22}c$$

True model for the outcome:
$$logitE[Y|a,m^*,c]=\theta_0+\theta_1a+\theta_2m1^*+\theta_3m2^*+\theta_4am1^*+\theta_5am2^*+\theta_6m1^*m2^*+\theta_7am1^*m2^*+\theta_8c$$

### Causal Effects and Standard Errors Estimated By the Natural Effect Model 

```{r}
causal_mediation(data = df_mulipleM_mint, model = "ne",
                 outcome = "binY_2binM_mint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_bin1','M_bin2'), 
                 EMMint = TRUE, EMMint.terms = c("A*M_bin1*M_bin2"),
                 covariates = "C", yreg = "logistic")
```

### Causal Effects and Standard Errors Estimated By the weighting-based approach 

```{r}
causal_mediation(data = df_mulipleM_mint, model = "wb",
                 outcome = "binY_2binM_mint", exposure = 'A', exposure.type = "binary",
                 mediator = c('M_bin1','M_bin2'), covariates = "C",
                 EMMint = TRUE, EMMint.terms = c("A*M_bin1*M_bin2"),
                 yreg = "logistic", m_star = c(0,0), nboot = 500)
```
