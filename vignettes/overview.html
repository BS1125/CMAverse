<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />


<meta name="date" content="2020-09-11" />

<title>Overview of Modeling Approaches for Causal Mediation Analysis</title>

<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>





<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Overview of Modeling Approaches for Causal Mediation Analysis</h1>
<h4 class="date">2020-09-11</h4>



<p>This document describes how the six causal mediation analysis approaches including <em>the regression-based approach</em> by <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3659198/">Valeri et al. (2013)</a> and <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4287269/">VanderWeele et al. (2014)</a>, <em>the weighting-based approach</em> by <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4287269/">VanderWeele et al. (2014)</a>, <em>the inverse odd-ratio weighting approach</em> by <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3954805/">Tchetgen Tchetgen (2013)</a>, <em>the natural effect model</em> by <a href="https://www.degruyter.com/view/journals/em/1/1/article-p131.xml?language=en">Vansteelandt et al. (2012)</a>, <em>the marginal structural model</em> by <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5560424/">VanderWeele et al. (2017)</a>, and <em>the <span class="math inline">\(g\)</span>-formula approach</em> by <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5285457/">Lin et al. (2017)</a> are implemented by the <code>cmest</code> function in the <code>CMAverse</code> package. See publications of these approaches for methodological details .</p>
<p>We categorize the approaches based on whether the approach deals with post-exposure confounding, i.e., there are mediator-outcome confounders affect by the exposure. <em>The regression-based approach</em>, <em>the weighting-based approach</em>, <em>the inverse odd-ratio weighting approach</em> and <em>the natural effect model</em> only deal with pre-exposure confounding. <em>The marginal structural model</em> and <em>the <span class="math inline">\(g\)</span>-formula approach</em> deal with both pre-exposure confounding and post-exposure confounding.</p>
<p>The outcome, the exposure and the set of pre-exposure confounder(s) are denoted as <span class="math inline">\(Y\)</span>, <span class="math inline">\(A\)</span> and <span class="math inline">\(C\)</span> respectively. The set of mediator(s) <span class="math inline">\(\{M_p\}_{p=1,...,k}\)</span> is denoted as <span class="math inline">\(M\)</span> and <span class="math inline">\(M=(M_1,...,M_k)\)</span> follows the temporal order of the mediator(s). The set of post-exposure confounder(s) <span class="math inline">\(\{L_q\}_{q=1,...,s}\)</span> is denoted as <span class="math inline">\(L\)</span> and <span class="math inline">\(L=(L_1,...,L_s)\)</span> follows the temporal order of the post-exposure confounder(s).</p>
<div id="pre-exposure-confounding" class="section level1">
<h1>Pre-exposure Confounding</h1>
<div id="dag" class="section level2">
<h2>DAG</h2>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="estimands" class="section level2">
<h2>Estimands</h2>
<p>For a continuous outcome, causal effects are estimated on the difference scale (summarized in table 1). For a categorical, count, or survival outcome, causal effects are estimated on the ratio scale (summarized in table 2). See <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3659198/">Valeri et al. (2013)</a> and <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4220271/">VanderWeele (2015)</a> for details about these effects.</p>
<table class="table table-bordered table-striped table-hover table-responsive table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
Table 1: Causal Effects on the Difference Scale
</caption>
<thead>
<tr>
<th style="text-align:left;">
Full Name
</th>
<th style="text-align:left;">
Abbreviation
</th>
<th style="text-align:left;">
Formula
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 20em; ">
Controlled Direct Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(CDE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{am}-Y_{a^*m}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Pure Natural Direct Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(PNDE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aM_a^*}-Y_{a^*M_a^*}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Total Natural Direct Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(TNDE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aM_a}-Y_{a^*M_a}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Pure Natural Indirect Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(PNIE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{a^*M_a}-Y_{a^*M_a^*}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Total Natural Indirect Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(TNIE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aM_a}-Y_{aM_a^*}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Total Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(TE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(PNDE+TNIE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Reference Interaction
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(INT_{ref}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(PNDE-CDE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Mediated Interaction
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(INT_{med}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(TNIE-PNIE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(CDE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{CDE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(CDE/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(INT_{ref}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{INT_{ref}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(INT_{ref}/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(INT_{med}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{INT_{med}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(INT_{med}/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(PNIE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{PNIE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(PNIE/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion Mediated
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(PM\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(TNIE/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion Attributable to Interaction
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(INT\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((INT_{ref}+INT_{med})/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion Eliminated
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(PE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((INT_{ref}+INT_{med}+PNIE)/TE\)</span>
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup></sup> <span class="math inline">\(a\)</span> and <span class="math inline">\(a^*\)</span> are two reference values for <span class="math inline">\(A\)</span>. <span class="math inline">\(m\)</span> is the reference value for <span class="math inline">\(M\)</span>. <span class="math inline">\(M_a\)</span> denotes the counterfactual value of <span class="math inline">\(M\)</span> that would have been observed had <span class="math inline">\(A\)</span> been set to be <span class="math inline">\(a\)</span>. <span class="math inline">\(Y_{am}\)</span> denotes the counterfactual value of <span class="math inline">\(Y\)</span> that would have been observed had <span class="math inline">\(A\)</span> been set to be <span class="math inline">\(a\)</span>, and <span class="math inline">\(M\)</span> to be <span class="math inline">\(m\)</span>. <span class="math inline">\(Y_{aMa*}\)</span> denotes the counterfactual value of <span class="math inline">\(Y\)</span> that would have been observed had <span class="math inline">\(A\)</span> been set to be <span class="math inline">\(a\)</span>, and <span class="math inline">\(M\)</span> to be <span class="math inline">\(M_{a*}\)</span>.
</td>
</tr>
</tfoot>
</table>
<table class="table table-bordered table-striped table-hover table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Table 2: Causal Effects on the Ratio Scale
</caption>
<thead>
<tr>
<th style="text-align:left;">
Full Name
</th>
<th style="text-align:left;">
Abbreviation
</th>
<th style="text-align:left;">
Formula
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 20em; ">
Controlled Direct Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rr^{CDE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{am}]/E[Y_{a^*m}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Pure Natural Direct Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rr^{PNDE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aM_a^*}]/E[Y_{a^*M_a^*}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Total Natural Direct Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rr^{TNDE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aM_a}]/E[Y_{a^*M_a}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Pure Natural Indirect Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rr^{PNIE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{a^*M_a}]/E[Y_{a^*M_a^*}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Total Natural Indirect Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rr^{TNIE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aM_a}]/E[Y_{aM_a^*}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Total Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rr^{TE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rr^{PNDE}\times rr^{TNIE}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Excess RR due to Controlled Direct Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(err^{CDE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((E[Y_{am}-Y_{a^*m}])/E[Y_{a^*M_a^*}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Excess RR due to Reference Interaction
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(err^{INT_{ref}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rr^{PNDE}-1-err^{CDE}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Excess RR due to Mediated Interaction
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(err^{INT_{med}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rr^{TNIE}*rr^{PNDE}-rr^{PNDE}-rr^{PNIE}+1\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Excess RR due to Pure Natural Indirect Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(err^{PNIE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rr^{PNIE}-1\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(err^{CDE}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{err^{CDE}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(err^{CDE}/(rr^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(err^{INT_{ref}}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{err^{INT_{ref}}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(err^{INT_{ref}}/(rr^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(err^{INT_{med}}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{err^{INT_{med}}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(err^{INT_{med}}/(rr^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(err^{PNIE}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{err^{PNIE}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(err^{PNIE}/(rr^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion Mediated
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(PM\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((rr^{PNDE}*(rr^{TNIE}-1))/(rr^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion Attributable to Interaction
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(INT\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((err^{INT_{ref}}+err^{INT_{med}})/(rr^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion Eliminated
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(PE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((err^{INT_{ref}}+err^{INT_{med}}+err^{PNIE})/(rr^{TE}-1)\)</span>
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup></sup> <span class="math inline">\(a\)</span> and <span class="math inline">\(a^*\)</span> are two reference values for <span class="math inline">\(A\)</span>. <span class="math inline">\(m\)</span> is the reference value for <span class="math inline">\(M\)</span>. <span class="math inline">\(M_a\)</span> denotes the counterfactual value of <span class="math inline">\(M\)</span> that would have been observed had <span class="math inline">\(A\)</span> been set to be <span class="math inline">\(a\)</span>. <span class="math inline">\(Y_{am}\)</span> denotes the counterfactual value of <span class="math inline">\(Y\)</span> that would have been observed had <span class="math inline">\(A\)</span> been set to be <span class="math inline">\(a\)</span>, and <span class="math inline">\(M\)</span> to be <span class="math inline">\(m\)</span>. <span class="math inline">\(Y_{aMa*}\)</span> denotes the counterfactual value of <span class="math inline">\(Y\)</span> that would have been observed had <span class="math inline">\(A\)</span> been set to be <span class="math inline">\(a\)</span>, and <span class="math inline">\(M\)</span> to be <span class="math inline">\(M_{a*}\)</span>. <span class="math inline">\(RR\)</span> represents risk or rate ratio. If <span class="math inline">\(Y\)</span> is categorical, a reference value of <span class="math inline">\(Y\)</span>, denoted as <span class="math inline">\(y\)</span>, is needed and E[Y] represents the probability of <span class="math inline">\(Y=y\)</span>.
</td>
</tr>
</tfoot>
</table>
</div>
<div id="the-regression-based-approach" class="section level2">
<h2>The Regression-based Approach</h2>
<p>With the regression-based approach, all causal effects are estimated through either closed-form parameter function estimation or direct counterfactual imputation estimation.</p>
<div id="closed-form-parameter-function-estimation" class="section level3">
<h3>Closed-form Parameter Function Estimation</h3>
<p>Closed-form parameter function estimation is available when there is only a single mediator, i.e., <span class="math inline">\(M=M_1\)</span>. Also, <code>yreg</code> must be chosen from <code>linear</code>, <code>logistic</code>, <code>loglinear</code>, <code>poisson</code>, <code>quasipoisson</code>, <code>negbin</code>, <code>coxph</code>, <code>aft_exp</code>, and <code>aft_weibull</code>. <code>mreg</code> must be chosen from <code>linear</code>, <code>logistic</code> and <code>multinomial</code>. To use <code>yreg = &quot;logistic&quot;</code> in closed-form parameter function estimation, the outcome must be rare. To use <code>yreg = &quot;coxph&quot;</code> in closed-form parameter function estimation, the outcome at the end of follow-up must be rare. Additionally, the causal effects estimated through closed-form parameter function estimation are conditional on values of pre-exposure confounders specified by the <code>precval</code> argument. Closed-form parameter functions are summarized below.</p>
<div id="linear-yreg-linear-mreg-and-noncategorical-exposure" class="section level4">
<h4>Linear <code>yreg</code>, Linear <code>mreg</code> and Noncategorical Exposure</h4>
<p>If the exposure is not categorical, <code>yreg=&quot;linear&quot;</code> and <code>mreg=list(&quot;linear&quot;)</code>, the <code>cmest</code> function estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a linear regression model for the mediator: <span class="math display">\[E[M|A,C]=\beta_0+\beta_1A+\beta_2&#39;C\]</span></p></li>
<li><p>Fit a linear regression model for the outcome: <span class="math display">\[E[Y|A,M,C]=\theta_0+\theta_1A+\theta_2M+\theta_3AM+\theta_4&#39;C\]</span></p></li>
<li><p>Estimate <span class="math inline">\(CDE\)</span>, <span class="math inline">\(PNDE\)</span>, <span class="math inline">\(TNDE\)</span>, <span class="math inline">\(PNIE\)</span> and <span class="math inline">\(TNIE\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(CDE=(\theta_1+\theta_3m)(a-a^*)\)</span></li>
<li><span class="math inline">\(PNDE=\{\theta_1+\theta_3(\beta_0+\beta_1a^*+\beta_2&#39;c)\}(a-a^*)\)</span></li>
<li><span class="math inline">\(TNDE=\{\theta_1+\theta_3(\beta_0+\beta_1a+\beta_2&#39;c)\}(a-a^*)\)</span></li>
<li><span class="math inline">\(PNIE=(\theta_2\beta_1+\theta_3\beta_1a^*)(a-a^*)\)</span></li>
<li><span class="math inline">\(TNIE=(\theta_2\beta_1+\theta_3\beta_1a)(a-a^*)\)</span></li>
</ul></li>
<li><p>Calculate other effects using formulas in table 1.</p></li>
</ol>
</div>
<div id="linear-yreg-linear-mreg-and-categorical-exposure" class="section level4">
<h4>Linear <code>yreg</code>, Linear <code>mreg</code> and Categorical Exposure</h4>
<p>If the exposure is categorical, <code>yreg=&quot;linear&quot;</code> and <code>mreg=list(&quot;linear&quot;)</code>, the <code>cmest</code> function estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a linear regression model for the mediator: <span class="math display">\[E[M|A,C]=\beta_0+\sum_{k=1}^H\beta_{1h}I\{A=h\}+\beta_2&#39;C\]</span></p></li>
<li><p>Fit a linear regression model for the outcome: <span class="math display">\[E[Y|A,M,C]=\theta_0+\sum_{h=1}^H\theta_{1h}I\{A=h\}+\theta_2M+\sum_{h=1}^H\theta_{3h}I\{A=h\}M+\theta_4&#39;C\]</span></p></li>
<li><p>Estimate <span class="math inline">\(CDE\)</span>, <span class="math inline">\(PNDE\)</span>, <span class="math inline">\(TNDE\)</span>, <span class="math inline">\(PNIE\)</span> and <span class="math inline">\(TNIE\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(CDE=\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+(\sum_{h=1}^H\theta_{3h}I\{a=h\}-\sum_{h=1}^H\theta_{3h}I\{a^*=h\})m\)</span></li>
<li><span class="math inline">\(PNDE=\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+(\sum_{h=1}^H\theta_{3h}I\{a=h\}-\sum_{h=1}^H\theta_{3h}I\{a^*=h\})(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2&#39;c)\)</span></li>
<li><span class="math inline">\(TNDE=\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+(\sum_{h=1}^H\theta_{3h}I\{a=h\}-\sum_{h=1}^H\theta_{3h}I\{a^*=h\})(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2&#39;c)\)</span></li>
<li><span class="math inline">\(PNIE=(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a^*=h\})(\sum_{h=1}^H\beta_{1h}I\{a=h\}-\sum_{h=1}^H\beta_{1h}I\{a^*=h\})\)</span></li>
<li><span class="math inline">\(TNIE=(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a=h\})(\sum_{h=1}^H\beta_{1h}I\{a=h\}-\sum_{h=1}^H\beta_{1h}I\{a^*=h\})\)</span></li>
</ul></li>
<li><p>Calculate other effects using formulas in table 1.</p></li>
</ol>
</div>
<div id="linear-yreg-logistic-mreg-and-noncategorical-exposure" class="section level4">
<h4>Linear <code>yreg</code>, Logistic <code>mreg</code> and Noncategorical Exposure</h4>
<p>If the exposure is not categorical, <code>yreg=&quot;linear&quot;</code> and <code>mreg=list(&quot;logistic&quot;)</code>, the <code>cmest</code> function estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a logistic regression model for the mediator: <span class="math display">\[logitE[M|A,C]=\beta_0+\beta_1A+\beta_2&#39;C\]</span></p></li>
<li><p>Fit a linear regression model for the outcome: <span class="math display">\[E[Y|A,M,C]=\theta_0+\theta_1A+\theta_2M+\theta_3AM+\theta_4&#39;C\]</span></p></li>
<li><p>Estimate <span class="math inline">\(CDE\)</span>, <span class="math inline">\(PNDE\)</span>, <span class="math inline">\(TNDE\)</span>, <span class="math inline">\(PNIE\)</span> and <span class="math inline">\(TNIE\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(CDE=(\theta_1+\theta_3m)(a-a^*)\)</span></li>
<li><span class="math inline">\(PNDE=\{\theta_1+\theta_3\frac{exp(\beta_0+\beta_1a^*+\beta_2&#39;c)}{1+exp(\beta_0+\beta_1a^*+\beta_2&#39;c)}\}(a-a^*)\)</span></li>
<li><span class="math inline">\(TNDE=\{\theta_1+\theta_3\frac{exp(\beta_0+\beta_1a+\beta_2&#39;c)}{1+exp(\beta_0+\beta_1a+\beta_2&#39;c)}\}(a-a^*)\)</span></li>
<li><span class="math inline">\(PNIE=(\theta_2+\theta_3a^*)(\frac{exp(\beta_0+\beta_1a+\beta_2&#39;c)}{1+exp(\beta_0+\beta_1a+\beta_2&#39;c)}-\frac{exp(\beta_0+\beta_1a^*+\beta_2&#39;c)}{1+exp(\beta_0+\beta_1a^*+\beta_2&#39;c)})\)</span></li>
<li><span class="math inline">\(TNIE=(\theta_2+\theta_3a)(\frac{exp(\beta_0+\beta_1a+\beta_2&#39;c)}{1+exp(\beta_0+\beta_1a+\beta_2&#39;c)}-\frac{exp(\beta_0+\beta_1a^*+\beta_2&#39;c)}{1+exp(\beta_0+\beta_1a^*+\beta_2&#39;c)})\)</span></li>
</ul></li>
<li><p>Calculate other effects using formulas in table 1.</p></li>
</ol>
</div>
<div id="linear-yreg-logistic-mreg-and-categorical-exposure" class="section level4">
<h4>Linear <code>yreg</code>, Logistic <code>mreg</code> and Categorical Exposure</h4>
<p>If the exposure is categorical, <code>yreg=&quot;linear&quot;</code> and <code>mreg=list(&quot;logistic&quot;)</code>, the <code>cmest</code> function estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a logistic regression model for the mediator: <span class="math display">\[logitE[M|A,C]=\beta_0+\sum_{h=1}^H\beta_{1h}I\{A=h\}+\beta_2&#39;C\]</span></p></li>
<li><p>Fit a linear regression model for the outcome: <span class="math display">\[E[Y|A,M,C]=\theta_0+\sum_{h=1}^H\theta_{1h}I\{A=h\}+\theta_2M+\sum_{h=1}^H\theta_{3h}I\{A=h\}M+\theta_4&#39;C\]</span></p></li>
<li><p>Estimate <span class="math inline">\(CDE\)</span>, <span class="math inline">\(PNDE\)</span>, <span class="math inline">\(TNDE\)</span>, <span class="math inline">\(PNIE\)</span> and <span class="math inline">\(TNIE\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(CDE=\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+(\sum_{h=1}^H\theta_{3h}I\{a=h\}-\sum_{h=1}^H\theta_{3h}I\{a^*=h\})m\)</span></li>
<li><span class="math inline">\(PNDE=\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+(\sum_{h=1}^H\theta_{3h}I\{a=h\}-\sum_{h=1}^H\theta_{3h}I\{a^*=h\})\frac{exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2&#39;c)}{1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2&#39;c)}\)</span></li>
<li><span class="math inline">\(TNDE=\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+(\sum_{h=1}^H\theta_{3h}I\{a=h\}-\sum_{h=1}^H\theta_{3h}I\{a^*=h\})\frac{exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2&#39;c)}{1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2&#39;c)}\)</span></li>
<li><span class="math inline">\(PNIE=(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a^*=h\})(\frac{exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2&#39;c)}{1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2&#39;c)}-\frac{exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2&#39;c)}{1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2&#39;c)})\)</span></li>
<li><span class="math inline">\(TNIE=(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a=h\})(\frac{exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2&#39;c)}{1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2&#39;c)}-\frac{exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2&#39;c)}{1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2&#39;c)})\)</span></li>
</ul></li>
<li><p>Calculate other effects using formulas in table 1.</p></li>
</ol>
</div>
<div id="linear-yreg-multinomial-mreg-and-noncategorical-exposure" class="section level4">
<h4>Linear <code>yreg</code>, Multinomial <code>mreg</code> and Noncategorical Exposure</h4>
<p>If the exposure is not categorical, <code>yreg=&quot;linear&quot;</code> and <code>mreg=list(&quot;multinomial&quot;)</code>, the <code>cmest</code> function estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a multinomial regression model for the mediator: <span class="math display">\[log\frac{E[M=j|A,C]}{E[M=0|A,C]}=\beta_{0j}+\beta_{1j}A+\beta_{2j}&#39;C, j=1,2,...,J\]</span></p></li>
<li><p>Fit a linear regression model for the outcome: <span class="math display">\[E[Y|A,M,C]=\theta_0+\theta_1A+\sum_{j=1}^J\theta_{2j}I\{M=j\}+A\sum_{j=1}^J\theta_{3j}I\{M=j\}+\theta_4&#39;C\]</span></p></li>
<li><p>Estimate <span class="math inline">\(CDE\)</span>, <span class="math inline">\(PNDE\)</span>, <span class="math inline">\(TNDE\)</span>, <span class="math inline">\(PNIE\)</span> and <span class="math inline">\(TNIE\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(CDE=(\theta_1+\sum_{j=1}^J\theta_{3j}I\{m=j\})(a-a^*)\)</span></li>
<li><span class="math inline">\(PNDE=\{\theta_1+\frac{\sum_{j=1}^J\theta_{3j}exp(\beta_{0j}+\beta_{1j}a^*+\beta_{2j}&#39;c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\beta_{1j}a^*+\beta_{2j}&#39;c)}\}(a-a^*)\)</span></li>
<li><span class="math inline">\(TNDE=\{\theta_1+\frac{\sum_{j=1}^J\theta_{3j}exp(\beta_{0j}+\beta_{1j}a+\beta_{2j}&#39;c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\beta_{1j}a+\beta_{2j}&#39;c)}\}(a-a^*)\)</span></li>
<li><span class="math inline">\(PNIE=\frac{\sum_{j=1}^J(\theta_{2j}+\theta_{3j}a^*)exp(\beta_{0j}+\beta_{1j}a+\beta_{2j}&#39;c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\beta_{1j}a+\beta_{2j}&#39;c)}-\frac{\sum_{j=1}^J(\theta_{2j}+\theta_{3j}a^*)exp(\beta_{0j}+\beta_{1j}a^*+\beta_{2j}&#39;c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\beta_{1j}a^*+\beta_{2j}&#39;c)}\)</span></li>
<li><span class="math inline">\(TNIE=\frac{\sum_{j=1}^J(\theta_{2j}+\theta_{3j}a)exp(\beta_{0j}+\beta_{1j}a+\beta_{2j}&#39;c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\beta_{1j}a+\beta_{2j}&#39;c)}-\frac{\sum_{j=1}^J(\theta_{2j}+\theta_{3j}a)exp(\beta_{0j}+\beta_{1j}a^*+\beta_{2j}&#39;c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\beta_{1j}a^*+\beta_{2j}&#39;c)}\)</span></li>
</ul></li>
<li><p>Calculate other effects using formulas in table 1.</p></li>
</ol>
</div>
<div id="linear-yreg-multinomial-mreg-and-categorical-exposure" class="section level4">
<h4>Linear <code>yreg</code>, Multinomial <code>mreg</code> and Categorical Exposure</h4>
<p>If the exposure is categorical, <code>yreg=&quot;linear&quot;</code> and <code>mreg=list(&quot;multinomial&quot;)</code>, the <code>cmest</code> function estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a multinomial regression model for the mediator: <span class="math display">\[log\frac{E[M=j|A,C]}{E[M=0|A,C]}=\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{A=h\}+\beta_{2j}&#39;C, j=1,2,...,J\]</span></p></li>
<li><p>Fit a linear regression model for the outcome: <span class="math display">\[E[Y|A,M,C]=\theta_0+\sum_{h=1}^H\theta_{1h}I\{A=h\}+\sum_{j=1}^J\theta_{2j}I\{M=j\}+\sum_{j=1}^J\sum_{h=1}^H\theta_{3jh}I\{M=j\}I\{A=h\}+\theta_4&#39;C\]</span></p></li>
<li><p>Estimate <span class="math inline">\(CDE\)</span>, <span class="math inline">\(PNDE\)</span>, <span class="math inline">\(TNDE\)</span>, <span class="math inline">\(PNIE\)</span> and <span class="math inline">\(TNIE\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(CDE=\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+(\sum_{j=1}^J\sum_{h=1}^H\theta_{3jh}I\{m=j\}I\{a=h\}-\sum_{j=1}^J\sum_{h=1}^H\theta_{3jh}I\{m=j\}I\{a^*=h\})\)</span></li>
<li><span class="math inline">\(PNDE=\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+\frac{\sum_{j=1}^J(\sum_{h=1}^H\theta_{3jh}I\{a=h\}-\sum_{h=1}^H\theta_{3jh}I\{a^*=h\})exp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}&#39;c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}&#39;c)}\)</span></li>
<li><span class="math inline">\(TNDE=\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+\frac{\sum_{j=1}^J(\sum_{h=1}^H\theta_{3jh}I\{a=h\}-\sum_{h=1}^H\theta_{3jh}I\{a^*=h\})exp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}&#39;c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}&#39;c)}\)</span></li>
<li><span class="math inline">\(PNIE=\frac{\sum_{j=1}^J(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a^*=h\})exp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}&#39;c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}&#39;c)}-\frac{\sum_{j=1}^J(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a^*=h\})exp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}&#39;c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}&#39;c)}\)</span></li>
<li><span class="math inline">\(TNIE=\frac{\sum_{j=1}^J(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a=h\})exp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}&#39;c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}&#39;c)}-\frac{\sum_{j=1}^J(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a=h\})exp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}&#39;c)}{1+\sum_{j=1}^Jexp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}&#39;c)}\)</span></li>
</ul></li>
<li><p>Calculate other effects using formulas in table 1.</p></li>
</ol>
</div>
<div id="nonlinear-yreg-linear-mreg-and-noncategorical-exposure" class="section level4">
<h4>Nonlinear <code>yreg</code>, Linear <code>mreg</code> and Noncategorical Exposure</h4>
<p>If the exposure is not categorical, <code>yreg!=&quot;linear&quot;</code> and <code>mreg=list(&quot;linear&quot;)</code>, the <code>cmest</code> function estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a linear regression model for the mediator: <span class="math display">\[E[M|A,C]=\beta_0+\beta_1A+\beta_2&#39;C+\epsilon_M,\epsilon_M\sim N(0,\sigma^2)\]</span></p></li>
<li><p>Fit the specified regression model for the outcome: <span class="math display">\[g(E[Y|A,M,C])=\theta_0+\theta_1A+\theta_2M+\theta_3AM+\theta_4&#39;C\]</span></p></li>
<li><p>Estimate <span class="math inline">\(rr^{CDE}\)</span>, <span class="math inline">\(rr^{PNDE}\)</span>, <span class="math inline">\(rr^{TNDE}\)</span>, <span class="math inline">\(rr^{PNIE}\)</span>, <span class="math inline">\(rr^{TNIE}\)</span> and <span class="math inline">\(err^{CDE}\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(rr^{CDE}=exp((\theta_1+\theta_3m)(a-a^*))\)</span></li>
<li><span class="math inline">\(rr^{PNDE}=exp(\{\theta_1+\theta_3(\beta_0+\beta_1a^*+\beta_2&#39;c+\theta_2\sigma^2)\}(a-a^*)+0.5\theta_3^2\sigma^2(a^2-a^{*2}))\)</span></li>
<li><span class="math inline">\(rr^{TNDE}=exp(\{\theta_1+\theta_3(\beta_0+\beta_1a+\beta_2&#39;c+\theta_2\sigma^2)\}(a-a^*)+0.5\theta_3^2\sigma^2(a^2-a^{*2}))\)</span></li>
<li><span class="math inline">\(rr^{PNIE}=exp((\theta_2\beta_1+\theta_3\beta_1a^*)(a-a^*))\)</span></li>
<li><span class="math inline">\(rr^{TNIE}=exp((\theta_2\beta_1+\theta_3\beta_1a)(a-a^*))\)</span></li>
<li><span class="math inline">\(err^{CDE}=(exp(\theta_1(a-a^*)+\theta_3am)-exp(\theta_3a^*m))exp(\theta_2m-(\theta_2+\theta_3a^*)(\beta_0+\beta_1a^*+\beta_2&#39;c)-0.5(\theta_2+\theta_3a^*)^2\sigma^2)\)</span></li>
</ul></li>
<li><p>Calculate other effects using formulas in table 2.</p></li>
</ol>
</div>
<div id="nonlinear-yreg-linear-mreg-and-categorical-exposure" class="section level4">
<h4>Nonlinear <code>yreg</code>, Linear <code>mreg</code> and Categorical Exposure</h4>
<p>If the exposure is categorical, <code>yreg!=&quot;linear&quot;</code> and <code>mreg=list(&quot;linear&quot;)</code>, the <code>cmest</code> function estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a linear regression model for the mediator: <span class="math display">\[E[M|A,C]=\beta_0+\sum_{h=1}^H\beta_{1h}I\{A=h\}+\beta_2&#39;C+\epsilon_M,\epsilon_M\sim N(0,\sigma^2)\]</span></p></li>
<li><p>Fit the specified regression model for the outcome: <span class="math display">\[g(E[Y|A,M,C])=\theta_0+\sum_{h=1}^H\theta_{1h}I\{A=h\}+\theta_2M+\sum_{h=1}^H\theta_{3h}I\{A=h\}M+\theta_4&#39;C\]</span></p></li>
<li><p>Estimate <span class="math inline">\(rr^{CDE}\)</span>, <span class="math inline">\(rr^{PNDE}\)</span>, <span class="math inline">\(rr^{TNDE}\)</span>, <span class="math inline">\(rr^{PNIE}\)</span>, <span class="math inline">\(rr^{TNIE}\)</span> and <span class="math inline">\(err^{CDE}\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(rr^{CDE}=exp(\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+(\sum_{h=1}^H\theta_{3h}I\{a=h\}-\sum_{h=1}^H\theta_{3h}I\{a^*=h\})m)\)</span></li>
<li><span class="math inline">\(rr^{PNDE}=exp(\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+(\sum_{h=1}^H\theta_{3h}I\{a=h\}-\sum_{h=1}^H\theta_{3h}I\{a^*=h\})(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2&#39;c+\theta_2\sigma^2)+0.5\sigma^2(\sum_{h=1}^H\theta_{3h}^2I\{a=h\}-\sum_{h=1}^H\theta_{3h}^2I\{a^*=h\}))\)</span></li>
<li><span class="math inline">\(rr^{TNDE}=exp(\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+(\sum_{h=1}^H\theta_{3h}I\{a=h\}-\sum_{h=1}^H\theta_{3h}I\{a^*=h\})(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2&#39;c+\theta_2\sigma^2)+0.5\sigma^2(\sum_{h=1}^H\theta_{3h}^2I\{a=h\}-\sum_{h=1}^H\theta_{3h}^2I\{a^*=h\}))\)</span></li>
<li><span class="math inline">\(rr^{PNIE}=exp(\theta_2(\sum_{h=1}^H\beta_{1h}I\{a=h\}-\sum_{h=1}^H\beta_{1h}I\{a^*=h\})+\sum_{h=1}^H\theta_{3h}I\{a^*=h\}(\sum_{h=1}^H\beta_{1h}I\{a=h\}-\sum_{h=1}^H\beta_{1h}I\{a^*=h\}))\)</span></li>
<li><span class="math inline">\(rr^{TNIE}=exp(\theta_2(\sum_{h=1}^H\beta_{1h}I\{a=h\}-\sum_{h=1}^H\beta_{1h}I\{a^*=h\})+\sum_{h=1}^H\theta_{3h}I\{a=h\}(\sum_{h=1}^H\beta_{1h}I\{a=h\}-\sum_{h=1}^H\beta_{1h}I\{a^*=h\}))\)</span></li>
<li><span class="math inline">\(err^{CDE}=(exp(\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+\sum_{h=1}^H\theta_{3h}I\{a=h\}m)-exp(\sum_{h=1}^H\theta_{3h}I\{a^*=h\}m))exp(\theta_2m-(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a^*=h\})(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2&#39;c)-0.5(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a^*=h\})^2\sigma^2)\)</span></li>
</ul></li>
<li><p>Calculate other effects using formulas in table 2.</p></li>
</ol>
</div>
<div id="nonlinear-yreg-logistic-mreg-and-noncategorical-exposure" class="section level4">
<h4>Nonlinear <code>yreg</code>, Logistic <code>mreg</code> and Noncategorical Exposure</h4>
<p>If the exposure is not categorical, <code>yreg!=&quot;linear&quot;</code> and <code>mreg=list(&quot;logistic&quot;)</code>, the <code>cmest</code> function estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a logistic regression model for the mediator: <span class="math display">\[logitE[M|A,C]=\beta_0+\beta_1A+\beta_2&#39;C\]</span></p></li>
<li><p>Fit the specified regression model for the outcome: <span class="math display">\[g(E[Y|A,M,C])=\theta_0+\theta_1A+\theta_2M+\theta_3AM+\theta_4&#39;C\]</span></p></li>
<li><p>Estimate <span class="math inline">\(rr^{CDE}\)</span>, <span class="math inline">\(rr^{PNDE}\)</span>, <span class="math inline">\(rr^{TNDE}\)</span>, <span class="math inline">\(rr^{PNIE}\)</span>, <span class="math inline">\(rr^{TNIE}\)</span> and <span class="math inline">\(err^{CDE}\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(rr^{CDE}=exp((\theta_1+\theta_3m)(a-a^*))\)</span></li>
<li><span class="math inline">\(rr^{PNDE}=\frac{exp(\theta_1a)\{1+exp(\theta_2+\theta_3a+\beta_0+\beta_1a^*+\beta_2&#39;c)\}}{exp(\theta_1a^*)\{1+exp(\theta_2+\theta_3a^*+\beta_0+\beta_1a^*+\beta_2&#39;c)\}}\)</span></li>
<li><span class="math inline">\(rr^{TNDE}=\frac{exp(\theta_1a)\{1+exp(\theta_2+\theta_3a+\beta_0+\beta_1a+\beta_2&#39;c)\}}{exp(\theta_1a^*)\{1+exp(\theta_2+\theta_3a^*+\beta_0+\beta_1a+\beta_2&#39;c)\}}\)</span></li>
<li><span class="math inline">\(rr^{PNIE}=\frac{\{1+exp(\beta_0+\beta_1a^*+\beta_2&#39;c)\}\{1+exp(\theta_2+\theta_3a^*+\beta_0+\beta_1a+\beta_2&#39;c)\}}{\{1+exp(\beta_0+\beta_1a+\beta_2&#39;c)\}\{1+exp(\theta_2+\theta_3a^*+\beta_0+\beta_1a^*+\beta_2&#39;c)\}}\)</span></li>
<li><span class="math inline">\(rr^{TNIE}=\frac{\{1+exp(\beta_0+\beta_1a^*+\beta_2&#39;c)\}\{1+exp(\theta_2+\theta_3a+\beta_0+\beta_1a+\beta_2&#39;c)\}}{\{1+exp(\beta_0+\beta_1a+\beta_2&#39;c)\}\{1+exp(\theta_2+\theta_3a+\beta_0+\beta_1a^*+\beta_2&#39;c)\}}\)</span></li>
<li><span class="math inline">\(err^{CDE}=\frac{exp(\theta_2m)(exp(\theta_1(a-a^*)+\theta_3am)-exp(\theta_3a^*m))(1+exp(\beta_0+\beta_1a^*+\beta_2&#39;c))}{1+exp(\beta_0+\beta_1a^*+\beta_2&#39;c+\theta_2+\theta_3a^*)}\)</span></li>
</ul></li>
<li><p>Calculate other effects using formulas in table 2.</p></li>
</ol>
</div>
<div id="nonlinear-yreg-logistic-mreg-and-categorical-exposure" class="section level4">
<h4>Nonlinear <code>yreg</code>, Logistic <code>mreg</code> and Categorical Exposure</h4>
<p>If the exposure is categorical, <code>yreg!=&quot;linear&quot;</code> and <code>mreg=list(&quot;logistic&quot;)</code>, the <code>cmest</code> function estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a logistic regression model for the mediator: <span class="math display">\[logitE[M|A,C]=\beta_0+\sum_{h=1}^H\beta_{1h}I\{A=h\}+\beta_2&#39;C\]</span></p></li>
<li><p>Fit the specified regression model for the outcome: <span class="math display">\[g(E[Y|A,M,C])=\theta_0+\sum_{h=1}^H\theta_{1h}I\{A=h\}+\theta_2M+\sum_{h=1}^H\theta_{3h}I\{A=h\}M+\theta_4&#39;C\]</span></p></li>
<li><p>Estimate <span class="math inline">\(rr^{CDE}\)</span>, <span class="math inline">\(rr^{PNDE}\)</span>, <span class="math inline">\(rr^{TNDE}\)</span>, <span class="math inline">\(rr^{PNIE}\)</span>, <span class="math inline">\(rr^{TNIE}\)</span> and <span class="math inline">\(err^{CDE}\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(rr^{CDE}=exp(\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+(\sum_{h=1}^H\theta_{3h}I\{a=h\}-\sum_{h=1}^H\theta_{3h}I\{a^*=h\})m)\)</span></li>
<li><span class="math inline">\(rr^{PNDE}=\frac{exp(\sum_{h=1}^H\theta_{1h}I\{a=h\})\{1+exp(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a=h\}+\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2&#39;c)\}}{exp(\sum_{h=1}^H\theta_{1h}I\{a^*=h\})\{1+exp(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a^*=h\}+\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2&#39;c)\}}\)</span></li>
<li><span class="math inline">\(rr^{TNDE}=\frac{exp(\sum_{h=1}^H\theta_{1h}I\{a=h\})\{1+exp(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a=h\}+\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2&#39;c)\}}{exp(\sum_{h=1}^H\theta_{1h}I\{a^*=h\})\{1+exp(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a^*=h\}+\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2&#39;c)\}}\)</span></li>
<li><span class="math inline">\(rr^{PNIE}=\frac{\{1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2&#39;c)\}\{1+exp(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a^*=h\}+\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2&#39;c)\}}{\{1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2&#39;c)\}\{1+exp(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a^*=h\}+\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2&#39;c)\}}\)</span></li>
<li><span class="math inline">\(rr^{TNIE}=\frac{\{1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2&#39;c)\}\{1+exp(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a=h\}+\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2&#39;c)\}}{\{1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a=h\}+\beta_2&#39;c)\}\{1+exp(\theta_2+\sum_{h=1}^H\theta_{3h}I\{a=h\}+\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2&#39;c)\}}\)</span></li>
<li><span class="math inline">\(err^{CDE}=\frac{exp(\theta_2m)(exp(\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+\sum_{h=1}^H\theta_{3h}I\{a=h\}m)-exp(\sum_{h=1}^H\theta_{3h}I\{a^*=h\}m))(1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2&#39;c))}{1+exp(\beta_0+\sum_{h=1}^H\beta_{1h}I\{a^*=h\}+\beta_2&#39;c+\theta_2+\sum_{h=1}^H\theta_{3h}I\{a^*=h\})}\)</span></li>
</ul></li>
<li><p>Calculate other effects using formulas in table 2.</p></li>
</ol>
</div>
<div id="nonlinear-yreg-multinomial-mreg-and-noncategorical-exposure" class="section level4">
<h4>Nonlinear <code>yreg</code>, Multinomial <code>mreg</code> and Noncategorical Exposure</h4>
<p>If the exposure is not categorical, <code>yreg!=&quot;linear&quot;</code> and <code>mreg=list(&quot;multinomial&quot;)</code>, the <code>cmest</code> function estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a multinomial regression model for the mediator: <span class="math display">\[log\frac{E[M=j|A,C]}{E[M=0|A,C]}=\beta_{0j}+\beta_{1j}A+\beta_{2j}&#39;C, j=1,2,...,J\]</span></p></li>
<li><p>Fit the specified regression model for the outcome: <span class="math display">\[g(E[Y|A,M,C])=\theta_0+\theta_1A+\sum_{j=1}^J\theta_{2j}I\{M=j\}+A\sum_{j=1}^J\theta_{3j}I\{M=j\}+\theta_4&#39;C\]</span></p></li>
<li><p>Estimate <span class="math inline">\(rr^{CDE}\)</span>, <span class="math inline">\(rr^{PNDE}\)</span>, <span class="math inline">\(rr^{TNDE}\)</span>, <span class="math inline">\(rr^{PNIE}\)</span>, <span class="math inline">\(rr^{TNIE}\)</span> and <span class="math inline">\(err^{CDE}\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(rr^{CDE}=exp((\theta_1+\sum_{j=1}^J\theta_{3j}I\{m=j\})(a-a^*))\)</span></li>
<li><span class="math inline">\(rr^{PNDE}=\frac{exp(\theta_1a)\{1+\sum_{j=1}^Jexp(\theta_{2j}+\theta_{3j}a+\beta_{0j}+\beta_{1j}a^*+\beta_{2j}&#39;c)\}}{exp(\theta_1a^*)\{1+\sum_{j=1}^Jexp(\theta_{2j}+\theta_{3j}a^*+\beta_{0j}+\beta_{1j}a^*+\beta_{2j}&#39;c)\}}\)</span></li>
<li><span class="math inline">\(rr^{TNDE}=\frac{exp(\theta_1a)\{1+\sum_{j=1}^Jexp(\theta_{2j}+\theta_{3j}a+\beta_{0j}+\beta_{1j}a+\beta_{2j}&#39;c)\}}{exp(\theta_1a^*)\{1+\sum_{j=1}^Jexp(\theta_{2j}+\theta_{3j}a^*+\beta_{0j}+\beta_{1j}a+\beta_{2j}&#39;c)\}}\)</span></li>
<li><span class="math inline">\(rr^{PNIE}=\frac{\{1+\sum_{j=1}^Jexp(\beta_{0j}+\beta_{1j}a^*+\beta_{2j}&#39;c)\}\{1+\sum_{j=1}^Jexp(\theta_{2j}+\theta_{3j}a^*+\beta_{0j}+\beta_{1j}a+\beta_{2j}&#39;c)\}}{\{1+\sum_{j=1}^Jexp(\beta_{0j}+\beta_{1j}a+\beta_{2j}&#39;c)\}\{1+\sum_{j=1}^Jexp(\theta_{2j}+\theta_{3j}a^*+\beta_{0j}+\beta_{1j}a^*+\beta_{2j}&#39;c)\}}\)</span></li>
<li><span class="math inline">\(rr^{TNIE}=\frac{\{1+\sum_{j=1}^Jexp(\beta_{0j}+\beta_{1j}a^*+\beta_{2j}&#39;c)\}\{1+\sum_{j=1}^Jexp(\theta_{2j}+\theta_{3j}a+\beta_{0j}+\beta_{1j}a+\beta_{2j}&#39;c)\}}{\{1+\sum_{j=1}^Jexp(\beta_{0j}+\beta_{1j}a+\beta_{2j}&#39;c)\}\{1+\sum_{j=1}^Jexp(\theta_{2j}+\theta_{3j}a+\beta_{0j}+\beta_{1j}a^*+\beta_{2j}&#39;c)\}}\)</span></li>
<li><span class="math inline">\(err^{CDE}=\frac{exp(\sum_{j=1}^J\theta_{2j}I\{m=j\})(1+\sum_{j=1}^Jexp(\beta_{0j}+\beta_{1j}a^*+\beta_{2j}&#39;c))(exp(\theta_1(a-a^*)+a\sum_{j=1}^J\theta_{3j}I\{m=j\})-exp(a^*\sum_{j=1}^J\theta_{3j}I\{m=j\}))}{1+\sum_{j=1}^Jexp(\theta_{2j}+\theta_{3j}a^*+\beta_{0j}+\beta_{1j}a^*+\beta_{2j}&#39;c)}\)</span></li>
</ul></li>
<li><p>Calculate other effects using formulas in table 2.</p></li>
</ol>
</div>
<div id="nonlinear-yreg-multinomial-mreg-and-categorical-exposure" class="section level4">
<h4>Nonlinear <code>yreg</code>, Multinomial <code>mreg</code> and Categorical Exposure</h4>
<p>If the exposure is categorical, <code>yreg!=&quot;linear&quot;</code> and <code>mreg=list(&quot;multinomial&quot;)</code>, the <code>cmest</code> function estimates the causal effects by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a multinomial regression model for the mediator: <span class="math display">\[log\frac{E[M=j|A,C]}{E[M=0|A,C]}=\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{A=h\}+\beta_{2j}&#39;C, j=1,2,...,J\]</span></p></li>
<li><p>Fit the specified regression model for the outcome: <span class="math display">\[g(E[Y|A,M,C])=\theta_0+\sum_{h=1}^H\theta_{1h}I\{A=h\}+\sum_{j=1}^J\theta_{2j}I\{M=j\}+\sum_{j=1}^J\sum_{h=1}^H\theta_{3jh}I\{M=j\}I\{A=h\}+\theta_4&#39;C\]</span></p></li>
<li><p>Estimate <span class="math inline">\(rr^{CDE}\)</span>, <span class="math inline">\(rr^{PNDE}\)</span>, <span class="math inline">\(rr^{TNDE}\)</span>, <span class="math inline">\(rr^{PNIE}\)</span>, <span class="math inline">\(rr^{TNIE}\)</span> and <span class="math inline">\(err^{CDE}\)</span> by the following parameter functions:</p>
<ul>
<li><span class="math inline">\(rr^{CDE}=exp(\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\}+\sum_{j=1}^J\sum_{h=1}^H\theta_{3jh}I\{m=l\}I\{a=h\}-\sum_{j=1}^J\sum_{h=1}^H\theta_{3jh}I\{m=l\}I\{a^*=h\})\)</span></li>
<li><span class="math inline">\(rr^{PNDE}=\frac{exp(\sum_{h=1}^H\theta_{1h}I\{a=h\})\{1+\sum_{j=1}^Jexp(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a=h\}+\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}&#39;c)\}}{exp(\sum_{h=1}^H\theta_{1h}I\{a^*=h\})\{1+\sum_{j=1}^Jexp(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a^*=h\}+\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}&#39;c)\}}\)</span></li>
<li><span class="math inline">\(rr^{TNDE}=\frac{exp(\sum_{h=1}^H\theta_{1h}I\{a=h\})\{1+\sum_{j=1}^Jexp(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a=h\}+\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}&#39;c)\}}{exp(\sum_{h=1}^H\theta_{1h}I\{a^*=h\})\{1+\sum_{j=1}^Jexp(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a^*=h\}+\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}&#39;c)\}}\)</span></li>
<li><span class="math inline">\(rr^{PNIE}=\frac{\{1+\sum_{j=1}^Jexp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}&#39;c)\}\{1+\sum_{j=1}^Jexp(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a^*=h\}+\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}&#39;c)\}}{\{1+\sum_{j=1}^Jexp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}&#39;c)\}\{1+\sum_{j=1}^Jexp(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a^*=h\}+\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}&#39;c)\}}\)</span></li>
<li><span class="math inline">\(rr^{TNIE}=\frac{\{1+\sum_{j=1}^Jexp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}&#39;c)\}\{1+\sum_{j=1}^Jexp(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a=h\}+\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}&#39;c)\}}{\{1+\sum_{j=1}^Jexp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a=h\}+\beta_{2j}&#39;c)\}\{1+\sum_{j=1}^Jexp(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a=h\}+\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}&#39;c)\}}\)</span></li>
<li><span class="math inline">\(err^{CDE}=\frac{exp(\sum_{j=1}^J\theta_{2j}I\{m=j\})(1+\sum_{j=1}^Jexp(\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}&#39;c))(exp((\sum_{h=1}^H\theta_{1h}I\{a=h\}-\sum_{h=1}^H\theta_{1h}I\{a^*=h\})+\sum_{j=1}^J\sum_{h=1}^H\theta_{3jh}I\{a=h\}I\{m=j\})-exp(\sum_{j=1}^J\sum_{h=1}^H\theta_{3jh}I\{a^*=h\}I\{m=j\}))}{1+\sum_{j=1}^Jexp(\theta_{2j}+\sum_{h=1}^H\theta_{3jh}I\{a^*=h\}+\beta_{0j}+\sum_{h=1}^H\beta_{1jh}I\{a^*=h\}+\beta_{2j}&#39;c)}\)</span></li>
</ul></li>
<li><p>Calculate other effects using formulas in table 2.</p></li>
</ol>
</div>
</div>
<div id="direct-counterfactural-imputation-estimation" class="section level3">
<h3>Direct Counterfactural Imputation Estimation</h3>
<p>The <code>cmest</code> function conducts direct counterfactural imputation estimation by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a regression model for <span class="math inline">\(E(Y|A,M,C)\)</span>. This regression model is specified by the <code>yreg</code> argument.</p></li>
<li><p>For <span class="math inline">\(p=1,...,k\)</span>, fit a regression model for the distribution of <span class="math inline">\(M_p\)</span> given <span class="math inline">\(A\)</span>, <span class="math inline">\(M_1\)</span>, …, <span class="math inline">\(M_{p-1}\)</span> and <span class="math inline">\(C\)</span>. These regression models are specified by the <code>mreg</code> argument.</p></li>
<li><p>For <span class="math inline">\(p=1,...,k\)</span> and <span class="math inline">\(i=1,...,n\)</span>, simulate the counterfacturals <span class="math inline">\(M_{a,p,i}\)</span> and <span class="math inline">\(M_{a^*,p,i}\)</span>.</p>
<ul>
<li>Simulate <span class="math inline">\(M_{a,p,i}\)</span> by randomly drawing a value from the distribution of <span class="math inline">\(M_{p}\)</span> given <span class="math inline">\(A=a,M_1=M_{a,1,i},...,M_{p-1}=M_{a,p-1,i},C=C_i\)</span>. Denote <span class="math inline">\(M_{a,i}=(M_{a,1,i},...,M_{a,k,i})^T\)</span>.</li>
<li>Simulate <span class="math inline">\(M_{a^*,p,i}\)</span> by randomly drawing a value from the distribution of <span class="math inline">\(M_{p}\)</span> given <span class="math inline">\(A=a^*,M_1=M_{a^*,1,i},...,M_{p-1}=M_{a^*,p-1,i},C=C_i\)</span>. Denote <span class="math inline">\(M_{a^*,i}=(M_{a^*,1,i},...,M_{a^*,k,i})^T\)</span>.</li>
</ul></li>
<li><p>For <span class="math inline">\(i=1,...,n\)</span>, obtain <span class="math inline">\(E[Y_i|A=a^*,M=m,C=C_i]\)</span>,<span class="math inline">\(E[Y_i|A=a,M=m,C=C_i]\)</span>,<span class="math inline">\(E[Y_i|A=a^*,M=M_{a^*,i},C=C_i]\)</span>,<span class="math inline">\(E[Y_i|A=a^*,M=M_{a,i},C=C_i]\)</span>,<span class="math inline">\(E[Y_i|A=a,M=M_{a^*,i},C=C_i]\)</span> and <span class="math inline">\(E[Y_i|A=a,M=M_{a,i},C=C_i]\)</span> from the regression model in step 1.</p></li>
<li><p>Impute the counterfacturals <span class="math inline">\(E[Y_{a^*m}]\)</span>, <span class="math inline">\(E[Y_{am}]\)</span>, <span class="math inline">\(E[Y_{a^*Ma^*}]\)</span>, <span class="math inline">\(E[Y_{aMa}]\)</span>, <span class="math inline">\(E[Y_{aMa^*}]\)</span> and <span class="math inline">\(E[Y_{a^*Ma}]\)</span>.</p>
<ul>
<li>Impute <span class="math inline">\(E[Y_{a^*m}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a^*,M=m,C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{am}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a,M=m,C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{a^*Ma^*}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a^*,M=M_{a^*,i},C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{aMa}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a,M=M_{a,i},C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{aMa^*}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a,M=M_{a^*,i},C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{a^*Ma}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a^*,M=M_{a,i},C=C_i]\}_{i=1,...,n}\)</span>.</li>
</ul></li>
<li><p>Calculate causal effects with formulas in table 1 or table 2.</p></li>
</ol>
</div>
</div>
<div id="the-weighting-based-approach" class="section level2">
<h2>The Weighting-based Approach</h2>
<p>With the weighting-based approach, the <code>cmest</code> function estimates causal effect through direct counterfactural imputation estimation by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a regression model for the distribution of <span class="math inline">\(E(Y|A,M,C)\)</span>. This regression model is specified by the <code>yreg</code> argument.</p></li>
<li><p>If <span class="math inline">\(C\)</span> is not empty, fit a regression model for <span class="math inline">\(P(A|C)\)</span> and obtain <span class="math inline">\(P(A=A_i|C=C_i)\)</span> for <span class="math inline">\(i=1,...,n\)</span>. This regression model is specified by the <code>ereg</code> argument.</p></li>
<li><p>For <span class="math inline">\(i=1,...,n\)</span>, obtain <span class="math inline">\(E[Y_i|A=a^*,M=m,C=C_i]\)</span>,<span class="math inline">\(E[Y_i|A=a,M=m,C=C_i]\)</span>,<span class="math inline">\(E[Y_i|A=a^*,M=M_{a^*,i},C=C_i]\)</span>,<span class="math inline">\(E[Y_i|A=a^*,M=M_{a,i},C=C_i]\)</span>,<span class="math inline">\(E[Y_i|A=a,M=M_{a^*,i},C=C_i]\)</span> and <span class="math inline">\(E[Y_i|A=a,M=M_{a,i},C=C_i]\)</span> from the regression model in step 1.</p></li>
<li><p>Impute the counterfacturals <span class="math inline">\(E[Y_{a^*m}]\)</span>, <span class="math inline">\(E[Y_{am}]\)</span>, <span class="math inline">\(E[Y_{a^*Ma^*}]\)</span>, <span class="math inline">\(E[Y_{aMa}]\)</span>, <span class="math inline">\(E[Y_{aMa^*}]\)</span> and <span class="math inline">\(E[Y_{a^*Ma}]\)</span>.</p>
<ul>
<li>Impute <span class="math inline">\(E[Y_{a^*m}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a^*,M=m,C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{am}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a,M=m,C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{a^*Ma^*}]\)</span> by taking a weighted average of <span class="math inline">\(\{Y_i\}_{i\in \{i:A_i=a^*\}}\)</span>, and each subject i is given a weight <span class="math inline">\(\frac{P(A=A_i)}{P(A=A_i|C=C_i)}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{aMa}]\)</span> by taking a weighted average of <span class="math inline">\(\{Y_i\}_{i\in \{i:A_i=a\}}\)</span>, and each subject i is given a weight <span class="math inline">\(\frac{P(A=A_i)}{P(A=A_i|C=C_i)}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{aMa^*}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a,M=M_i,C=C_i]\}_{i\in \{i:A_i=a^*\}}\)</span>, and each subject i is given a weight <span class="math inline">\(\frac{P(A=A_i)}{P(A=A_i|C=C_i)}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{a^*Ma}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a^*,M=M_i,C=C_i]\}_{i\in \{i:A_i=a\}}\)</span>, and each subject i is given a weight <span class="math inline">\(\frac{P(A=A_i)}{P(A=A_i|C=C_i)}\)</span>.</li>
</ul></li>
<li><p>Calculate causal effects with formulas in table 1 or table 2.</p></li>
</ol>
</div>
<div id="the-inverse-odds-ratio-weighting-approach" class="section level2">
<h2>The Inverse Odds Ratio Weighting Approach</h2>
<p>With the inverse odds ratio weighting approach, the <code>cmest</code> function estimates causal effect through direct counterfactural imputation estimation by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a regression model for <span class="math inline">\(P(A|M,C)\)</span> and obtain <span class="math inline">\(\frac{P(A=0|M=M_i,C=C_i)}{P(A=A_i|M=M_i,C=C_i)}\)</span> for <span class="math inline">\(i=1,...,n\)</span>. This regression model is specified by the <code>ereg</code> argument.</p></li>
<li><p>Fit a regression model for <span class="math inline">\(E(Y|A,C)\)</span>. This regression model is specified by the <code>yreg</code> argument.</p></li>
<li><p>Fit a weighted regression model for <span class="math inline">\(E(Y|A,C)\)</span> and each subject <span class="math inline">\(i\)</span> is given a weight <span class="math inline">\(\frac{P(A=0|M=M_i,C=C_i)}{P(A=A_i|M=M_i,C=C_i)}\)</span>. This regression model is obtained by adding the weights to the regression model in step 2.</p></li>
<li><p>Impute the counterfacturals <span class="math inline">\(E_{tot}[Y_{a}]\)</span>, <span class="math inline">\(E_{tot}[Y_{a^*}]\)</span>, <span class="math inline">\(E_{dir}[Y_{a}]\)</span> and <span class="math inline">\(E_{dir}[Y_{a^*}]\)</span>.</p>
<ul>
<li>Impute <span class="math inline">\(E_{tot}[Y_{a}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a,C=C_i]\}_{i=1,...,n}\)</span> obtained from the regression model in step 2.</li>
<li>Impute <span class="math inline">\(E_{tot}[Y_{a^*}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a^*,C=C_i]\}_{i=1,...,n}\)</span> obtained from the regression model in step 2.</li>
<li>Impute <span class="math inline">\(E_{dir}[Y_{a}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a,C=C_i]\}_{i=1,...,n}\)</span> obtained from the regression model in step 3 and each subject <span class="math inline">\(i\)</span> is given a weight <span class="math inline">\(\frac{P(A=0|M=M_i,C=C_i)}{P(A=A_i|M=M_i,C=C_i)}\)</span>.</li>
<li>Impute <span class="math inline">\(E_{dir}[Y_{a^*}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a^*,C=C_i]\}_{i=1,...,n}\)</span> obtained from the regression model in step 3 and each subject <span class="math inline">\(i\)</span> is given a weight <span class="math inline">\(\frac{P(A=0|M=M_i,C=C_i)}{P(A=A_i|M=M_i,C=C_i)}\)</span>.</li>
</ul></li>
<li><ul>
<li>For continuous outcome, calculate <span class="math inline">\(TE\)</span> by <span class="math inline">\(E_{tot}[Y_{a}]-E_{tot}[Y_{a^*}]\)</span>, calculate <span class="math inline">\(PNDE\)</span> by <span class="math inline">\(E_{dir}[Y_{a}]-E_{dir}[Y_{a^*}]\)</span> and calculate <span class="math inline">\(TNIE\)</span> by <span class="math inline">\(TE-PNDE\)</span>.</li>
<li>For categorical, count or survival outcome, calculate <span class="math inline">\(TE\)</span> by <span class="math inline">\(E_{tot}[Y_{a}]/E_{tot}[Y_{a^*}]\)</span>, calculate <span class="math inline">\(PNDE\)</span> by <span class="math inline">\(E_{dir}[Y_{a}]/E_{dir}[Y_{a^*}]\)</span> and calculate <span class="math inline">\(TNIE\)</span> by <span class="math inline">\(TE/PNDE\)</span>.</li>
</ul></li>
</ol>
</div>
<div id="the-natural-effect-model" class="section level2">
<h2>The Natural Effect Model</h2>
<p>With the natural effect model, the <code>cmest</code> function estimates causal effect through direct counterfactural imputation estimation by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Fit a regression model for <span class="math inline">\(E(Y|A,M,C)\)</span>. This regression model is specified by the <code>yreg</code> argument.</p></li>
<li><p>Expand the dataset using the regression model in step 1 and the <code>neImpute</code> function in the <code>medflex</code> package.</p></li>
<li><p>Fit the regression model in step 1 by the expanded dataset in step 2 with the exposure in the regression formula replaced by <span class="math inline">\(A0\)</span> and mediators in the regression formula replaced by <span class="math inline">\(A1\)</span>, i.e., <span class="math inline">\(Y\sim A0+A1+A0*A1+C\)</span> if the regression formula in step 1 is <span class="math inline">\(Y\sim A+M_1+M_2+A*M_1+C\)</span>.</p></li>
<li><p>For <span class="math inline">\(i=1,...,n\)</span>, obtain <span class="math inline">\(E[Y_i|A=a^*,M=m,C=C_i]\)</span> and <span class="math inline">\(E[Y_i|A=a,M=m,C=C_i]\)</span> from the regression model in step 1; obtain <span class="math inline">\(E[Y_i|A0=a^*,A1=a^*,C=C_i]\)</span>,<span class="math inline">\(E[Y_i|A0=a^*,A1=a,C=C_i]\)</span>,<span class="math inline">\(E[Y_i|A0=a,A1=a^*,C=C_i]\)</span> and <span class="math inline">\(E[Y_i|A0=a,A1=a,C=C_i]\)</span> from the regression model in step 3.</p></li>
<li><p>Impute the counterfacturals <span class="math inline">\(E[Y_{a^*m}]\)</span>, <span class="math inline">\(E[Y_{am}]\)</span>, <span class="math inline">\(E[Y_{a^*Ma^*}]\)</span>, <span class="math inline">\(E[Y_{aMa}]\)</span>, <span class="math inline">\(E[Y_{aMa^*}]\)</span> and <span class="math inline">\(E[Y_{a^*Ma}]\)</span>.</p>
<ul>
<li>Impute <span class="math inline">\(E[Y_{a^*m}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a^*,M=m,C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{am}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a,M=m,C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{a^*Ma^*}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a^*,A1=a^*,C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{aMa}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a,A1=a,C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{aMa^*}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a,A1=a^*,C=C_i]\}_{i=1,...,n}\)</span>.</li>
<li>Impute <span class="math inline">\(E[Y_{a^*Ma}]\)</span> by taking an average of <span class="math inline">\(\{E[Y_i|A=a^*,A1=a,C=C_i]\}_{i=1,...,n}\)</span>.</li>
</ul></li>
<li><p>Calculate causal effects with formulas in table 1 or table 2.</p></li>
</ol>
</div>
</div>
<div id="post-exposure-confounding" class="section level1">
<h1>Post-exposure Confounding</h1>
<div id="dag-1" class="section level2">
<h2>DAG</h2>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="estimands-1" class="section level2">
<h2>Estimands</h2>
<p>For a continuous outcome, causal effects are estimated on the difference scale (summarized in table 3). For a categorical, count, or survival outcome, causal effects are estimated on the ratio scale (summarized in table 4). Because of the existence of <span class="math inline">\(L\)</span>, some causal effects in table 1 and table 2 are not identifiable. However, their randomized analogues are identifiable. See <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4214081/">VanderWeele et al. (2014)</a> for details about randomized analogues of causal effects.</p>
<table class="table table-bordered table-striped table-hover table-responsive table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
Table 3: Causal Effects on the Difference Scale
</caption>
<thead>
<tr>
<th style="text-align:left;">
Full Name
</th>
<th style="text-align:left;">
Abbreviation
</th>
<th style="text-align:left;">
Formula
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 20em; ">
Controlled Direct Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(CDE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{am}-Y_{a^*m}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(PNDE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rPNDE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aG_{a^*}}-Y_{a^*G_{a^*}}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(TNDE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rTNDE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aG_{a}}-Y_{a^*G_{a}}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(PNIE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rPNIE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{a^*G_{a}}-Y_{a^*G_{a^*}}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(TNIE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rTNIE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aG_{a}}-Y_{aG_{a^*}}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Total Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(TE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rPNDE+rTNIE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(INT_{ref}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rINT_{ref}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rPNDE-CDE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(INT_{med}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rINT_{med}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rTNIE-rPNIE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(CDE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{CDE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(CDE/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(rINT_{ref}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{rINT_{ref}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rINT_{ref}/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(rINT_{med}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{rINT_{med}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rINT_{med}/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(rPNIE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{rPNIE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rPNIE/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(PM\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rPM\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rTNIE/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(INT\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rINT\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((rINT_{ref}+rINT_{med})/TE\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(PE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rPE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((rINT_{ref}+rINT_{med}+rPNIE)/TE\)</span>
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup></sup> <span class="math inline">\(a\)</span> and <span class="math inline">\(a^*\)</span> are two reference values for <span class="math inline">\(A\)</span>. <span class="math inline">\(m\)</span> is the reference value for <span class="math inline">\(M\)</span>. <span class="math inline">\(G_{a}\)</span> denotes a random draw from the distribution of <span class="math inline">\(M\)</span> among those with <span class="math inline">\(A=a\)</span>. <span class="math inline">\(Y_{am}\)</span> denotes the counterfactual value of <span class="math inline">\(Y\)</span> that would have been observed had <span class="math inline">\(A\)</span> been set to be <span class="math inline">\(a\)</span>, and <span class="math inline">\(M\)</span> to be <span class="math inline">\(m\)</span>. <span class="math inline">\(Y_{aG_{a*}}\)</span> denotes the counterfactual value of <span class="math inline">\(Y\)</span> that would have been observed had <span class="math inline">\(A\)</span> been set to be <span class="math inline">\(a\)</span>, and <span class="math inline">\(M\)</span> to be <span class="math inline">\(G_{a*}\)</span>.
</td>
</tr>
</tfoot>
</table>
<table class="table table-bordered table-striped table-hover table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Table 4: Causal Effects on the Ratio Scale
</caption>
<thead>
<tr>
<th style="text-align:left;">
Full Name
</th>
<th style="text-align:left;">
Abbreviation
</th>
<th style="text-align:left;">
Formula
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 20em; ">
Controlled Direct Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rr^{CDE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{am}]/E[Y_{a^*m}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(PNDE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rr^{rPNDE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aG_{a^*}}]/E[Y_{a^*G_{a^*}}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(TNDE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rr^{rTNDE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aG_{a}}]/E[Y_{a^*G_{a}}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(PNIE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rr^{rPNIE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{a^*G_{a}}]/E[Y_{a^*G_{a^*}}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(TNIE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rr^{rTNIE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(E[Y_{aG_{a}}]/E[Y_{aG_{a^*}}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Total Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rr^{TE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rr^{rPNDE}\times rr^{rTNIE}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Excess RR due to Controlled Direct Effect
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(err^{CDE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((E[Y_{am}-Y_{a^*m}])/E[Y_{a^*M_a^*}]\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(err^{INT_{ref}}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rerr^{INT_{ref}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rr^{rPNDE}-1-err^{CDE}\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(err^{INT_{med}}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rerr^{INT_{med}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rr^{rTNIE}*rr^{rPNDE}-rr^{rPNDE}-rr^{rPNIE}+1\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(err^{PNIE}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rerr^{PNIE}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rr^{rPNIE}-1\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(err^{CDE}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{err^{CDE}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(err^{CDE}/(rr^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(rerr^{INT_{ref}}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{rerr^{INT_{ref}}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rerr^{INT_{ref}}/(rr^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(rerr^{INT_{med}}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{rerr^{INT_{med}}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rerr^{INT_{med}}/(rr^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Proportion <span class="math inline">\(rerr^{PNIE}\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(prop^{rerr^{PNIE}}\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\(rerr^{PNIE}/(rr^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(PM\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rPM\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((rr^{rPNDE}*(rr^{rTNIE}-1))/(rr^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(INT\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rINT\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((rerr^{INT_{ref}}+rerr^{INT_{med}})/(rr^{TE}-1)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 20em; ">
Randomized Analogue of <span class="math inline">\(PE\)</span>
</td>
<td style="text-align:left;width: 8em; ">
<span class="math inline">\(rPE\)</span>
</td>
<td style="text-align:left;width: 10em; ">
<span class="math inline">\((rerr^{INT_{ref}}+rerr^{INT_{med}}+rerr^{PNIE})/(rr^{TE}-1)\)</span>
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup></sup> <span class="math inline">\(a\)</span> and <span class="math inline">\(a^*\)</span> are two reference values for <span class="math inline">\(A\)</span>. <span class="math inline">\(m\)</span> is the reference value for <span class="math inline">\(M\)</span>. <span class="math inline">\(G_{a}\)</span> denotes a random draw from the distribution of <span class="math inline">\(M\)</span> among those with <span class="math inline">\(A=a\)</span>. <span class="math inline">\(Y_{am}\)</span> denotes the counterfactual value of <span class="math inline">\(Y\)</span> that would have been observed had <span class="math inline">\(A\)</span> been set to be <span class="math inline">\(a\)</span>, and <span class="math inline">\(M\)</span> to be <span class="math inline">\(m\)</span>. <span class="math inline">\(Y_{aG_{a*}}\)</span> denotes the counterfactual value of <span class="math inline">\(Y\)</span> that would have been observed had <span class="math inline">\(A\)</span> been set to be <span class="math inline">\(a\)</span>, and <span class="math inline">\(M\)</span> to be <span class="math inline">\(G_{a*}\)</span>. <span class="math inline">\(RR\)</span> represents risk or rate ratio.
</td>
</tr>
</tfoot>
</table>
</div>
<div id="the-marginal-structural-model" class="section level2">
<h2>The Marginal Structural Model</h2>
<p>With the marginal structural model, the <code>cmest</code> function estimates causal effect through direct counterfactural imputation estimation by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>For <span class="math inline">\(p=1,...,k\)</span>, fit the regression model specified by <code>wmreg[p]</code> for <span class="math inline">\(P(M_p|A,M_1, ...,M_{p-1},L,C)\)</span> and obtain <span class="math inline">\(P(M_p=M_{p,i}|A=A_i,M_1=M_{1,i},...,M_{p-1}=M_{p-1,i},L=L_i,C=C_i)\)</span> for <span class="math inline">\(i=1,...,n\)</span>.</p></li>
<li><p>For <span class="math inline">\(p=1,...,k\)</span>, fit the regression model specified by <code>mreg[p]</code> for <span class="math inline">\(P(M_p|A,M_1, ...,M_{p-1})\)</span> and obtain <span class="math inline">\(P(M_p=M_{p,i}|A=A_i,M_1=M_{1,i},...,M_{p-1}=M_{p-1,i})\)</span> for <span class="math inline">\(i=1,...,n\)</span>.</p></li>
<li><p>If <span class="math inline">\(C\)</span> is not empty, fit the regression model specified by <code>ereg</code> for <span class="math inline">\(P(A|C)\)</span> and obtain <span class="math inline">\(P(A=A_i|C=C_i)\)</span> for <span class="math inline">\(i=1,...,n\)</span>.</p></li>
<li><p>Add weights to the regression model specified by <code>yreg</code> for <span class="math inline">\(E(Y|A,M)\)</span> and each subject <span class="math inline">\(i,i=1,...,n\)</span> is given a weight <span class="math inline">\(\frac{P(A=A_i)}{P(A=A_i|C=C_i)}\frac{P(M_1=M_{1,i}|A=A_i)}{P(M_1=M_{1,i}|A=A_i,C=C_i,L=L_i)}...\frac{P(M_k=M_{k,i}|A=A_i,M_1=M_{1,i},...,M_{k-1}=M_{k-1,i})}{P(M_k=M_{k,i}|A=A_i,M_1=M_{1,i},...,M_{k-1}=M_{k-1,i},C=C_i,L=L_i)}\)</span>.</p></li>
<li><p>For <span class="math inline">\(p=1,...,k\)</span>, add weights to the regression model specified by <code>mreg[p]</code> for the distribution of <span class="math inline">\(M_p\)</span> given <span class="math inline">\(A\)</span>, <span class="math inline">\(M_1\)</span>,…,<span class="math inline">\(M_{p-1}\)</span> and each subject <span class="math inline">\(i,i=1,...,n\)</span> is given a weight <span class="math inline">\(\frac{P(A=A_i)}{P(A=A_i|C=C_i)}\)</span>.</p></li>
<li><p>For <span class="math inline">\(p=1,...,k\)</span> and <span class="math inline">\(i=1,...,n\)</span>, simulate the counterfacturals <span class="math inline">\(M_{a,p,i}\)</span> and <span class="math inline">\(M_{a^*,p,i}\)</span> from the regression models in step 5.</p>
<ul>
<li>Simulate <span class="math inline">\(M_{a,p,i}\)</span> by randomly drawing a value from the distribution of <span class="math inline">\(M_{p}\)</span> given <span class="math inline">\(A=a,M_1=M_{a,1,i},...,M_{p-1}=M_{a,p-1,i}\)</span>. Denote <span class="math inline">\(M_{a,i}=(M_{a,1,i},...,M_{a,k,i})^T\)</span>.</li>
<li>Simulate <span class="math inline">\(M_{a^*,p,i}\)</span> by randomly drawing a value from the distribution of <span class="math inline">\(M_{p}\)</span> given <span class="math inline">\(A=a^*,M_1=M_{a^*,1,i},...,M_{p-1}=M_{a^*,p-1,i}\)</span>. Denote <span class="math inline">\(M_{a^*,i}=(M_{a^*,1,i},...,M_{a^*,k,i})^T\)</span>.</li>
</ul></li>
<li><p>For <span class="math inline">\(i=1,...,n\)</span>, obtain <span class="math inline">\(E[Y_i|A=a^*,M=m]\)</span>,<span class="math inline">\(E[Y_i|A=a,M=m]\)</span>,<span class="math inline">\(E[Y_i|A=a^*,M=M_{a^*,i}]\)</span>,<span class="math inline">\(E[Y_i|A=a^*,M=M_{a,i}]\)</span>,<span class="math inline">\(E[Y_i|A=a,M=M_{a^*,i}]\)</span> and <span class="math inline">\(E[Y_i|A=a,M=M_{a,i}]\)</span> from the regression model in step 4.</p></li>
<li><p>Impute the counterfacturals <span class="math inline">\(E[Y_{a^*m}]\)</span>, <span class="math inline">\(E[Y_{am}]\)</span>, <span class="math inline">\(E[Y_{a^*Ga^*}]\)</span>, <span class="math inline">\(E[Y_{aGa}]\)</span>, <span class="math inline">\(E[Y_{aGa^*}]\)</span> and <span class="math inline">\(E[Y_{a^*Ga}]\)</span>.</p>
<ul>
<li>Impute <span class="math inline">\(E[Y_{a^*m}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a^*,M=m]\}_{i=1,...,n}\)</span>;</li>
<li>Impute <span class="math inline">\(E[Y_{am}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a,M=m]\}_{i=1,...,n}\)</span>;</li>
<li>Impute <span class="math inline">\(E[Y_{a^*Ga^*}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a^*,M=M_{a^*,i}]\}_{i=1,...,n}\)</span>;</li>
<li>Impute <span class="math inline">\(E[Y_{aGa}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a,M=M_{a,i}]\}_{i=1,...,n}\)</span>;</li>
<li>Impute <span class="math inline">\(E[Y_{aGa^*}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a,M=M_{a^*,i}]\}_{i=1,...,n}\)</span>;</li>
<li>Impute <span class="math inline">\(E[Y_{a^*Ga}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a^*,M=M_{a,i}]\}_{i=1,...,n}\)</span>,</li>
</ul>
<p>each subject <span class="math inline">\(i,i=1,...,n\)</span> is given a weight <span class="math inline">\(\frac{P(A=A_i)}{P(A=A_i|C=C_i)}\frac{P(M_1=M_{1,i}|A=A_i)}{P(M_1=M_{1,i}|A=A_i,C=C_i,L=L_i)}...\frac{P(M_k=M_{k,i}|A=A_i,M_1=M_{1,i},...,M_{k-1}=M_{k-1,i})}{P(M_k=M_{k,i}|A=A_i,M_1=M_{1,i},...,M_{k-1}=M_{k-1,i},C=C_i,L=L_i)}\)</span>.</p></li>
<li><p>Calculate causal effects with formulas in table 3 or table 4.</p></li>
</ol>
</div>
<div id="the-g-formula-approach" class="section level2">
<h2>The <span class="math inline">\(G\)</span>-formula Approach</h2>
<p>With the <span class="math inline">\(g\)</span>-formula approach, the <code>cmest</code> function estimates causal effect through direct counterfactural imputation estimation by the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>For <span class="math inline">\(q=1,...,s\)</span>, fit the regression model specified by <code>postcreg[q]</code> for the distribution of <span class="math inline">\(L_q\)</span> given <span class="math inline">\(A\)</span>, <span class="math inline">\(L_1\)</span>, …, <span class="math inline">\(L_{q-1}\)</span> and <span class="math inline">\(C\)</span>.</p></li>
<li><p>For <span class="math inline">\(q=1,...,s\)</span> and <span class="math inline">\(i=1,...,n\)</span>, simulate the counterfacturals <span class="math inline">\(L_{a,q,i}\)</span> and <span class="math inline">\(L_{a^*,q,i}\)</span> from the regression models in step 1.</p>
<ul>
<li>Simulate <span class="math inline">\(L_{a,q,i}\)</span> by randomly drawing a value from the distribution of <span class="math inline">\(L_{q}\)</span> given <span class="math inline">\(A=a,L_1=L_{a,1,i},...,L_{q-1}=L_{a,q-1,i},C=C_i\)</span>. Denote <span class="math inline">\(L_{a,i}=(L_{a,1,i},...,L_{a,s,i})^T\)</span>.</li>
<li>Simulate <span class="math inline">\(L_{a^*,q,i}\)</span> by randomly drawing a value from the distribution of <span class="math inline">\(L_{q}\)</span> given <span class="math inline">\(A=a^*,L_1=L_{a^*,1,i},...,L_{q-1}=L_{a^*,q-1,i},C=C_i\)</span>. Denote <span class="math inline">\(L_{a^*,i}=(L_{a^*,1,i},...,L_{a^*,s,i})^T\)</span>.</li>
</ul></li>
<li><p>For <span class="math inline">\(p=1,...,k\)</span>, fit the regression model specified by <code>mreg[p]</code> for the distribution of <span class="math inline">\(M_p\)</span> given <span class="math inline">\(A\)</span>, <span class="math inline">\(M_1\)</span>, …, <span class="math inline">\(M_{p-1}\)</span>, <span class="math inline">\(L\)</span> and <span class="math inline">\(C\)</span>.</p></li>
<li><p>For <span class="math inline">\(p=1,...,k\)</span> and <span class="math inline">\(i=1,...,n\)</span>, simulate the counterfacturals <span class="math inline">\(M_{a,p,i}\)</span> and <span class="math inline">\(M_{a^*,p,i}\)</span> from the regression models in step 3.</p>
<ul>
<li>Simulate <span class="math inline">\(M_{a,p,i}\)</span> by randomly drawing a value from the distribution of <span class="math inline">\(M_{p}\)</span> given <span class="math inline">\(A=a,M_1=M_{a,1,i},...,M_{p-1}=M_{a,p-1,i},L=L_{a,i},C=C_i\)</span>. Denote <span class="math inline">\(M_{a,i}=(M_{a,1,i},...,M_{a,k,i})^T\)</span>.</li>
<li>Simulate <span class="math inline">\(M_{a^*,p,i}\)</span> by randomly drawing a value from the distribution of <span class="math inline">\(M_{p}\)</span> given <span class="math inline">\(A=a^*,M_1=M_{a^*,1,i},...,M_{p-1}=M_{a^*,p-1,i},L=L_{a^*,i},C=C_i\)</span>. Denote <span class="math inline">\(M_{a^*,i}=(M_{a^*,1,i},...,M_{a^*,k,i})^T\)</span>.</li>
</ul></li>
<li><p>Obtain <span class="math inline">\(\{G_{a,i}\}_{i=1,...,n}\)</span> by randomly permuting <span class="math inline">\(\{M_{a,i}\}_{i=1,...,n}\)</span> and obtain <span class="math inline">\(\{G_{a^*,i}\}_{i=1,...,n}\)</span> by randomly permuting <span class="math inline">\(\{M_{a^*,i}\}_{i=1,...,n}\)</span>.</p></li>
<li><p>Fit the regression model specified by <code>yreg</code> for <span class="math inline">\(E(Y|A,M,L,C)\)</span>.</p></li>
<li><p>For <span class="math inline">\(i=1,...,n\)</span>, obtain <span class="math inline">\(E[Y_i|A=a^*,M=m,L=L_{a^*,i},C=C_i]\)</span>,<span class="math inline">\(E[Y_i|A=a,M=m,L=L_{a,i},C=C_i]\)</span>,<span class="math inline">\(E[Y_i|A=a^*,M=G_{a^*,i},L=L_{a^*,i},C=C_i]\)</span>,<span class="math inline">\(E[Y_i|A=a^*,M=G_{a,i},L=L_{a^*,i},C=C_i]\)</span>,<span class="math inline">\(E[Y_i|A=a,M=G_{a^*,i},L=L_{a,i},C=C_i]\)</span> and <span class="math inline">\(E[Y_i|A=a,M=G_{a,i},L=L_{a,i},C=C_i]\)</span> from the regression model in step 5.</p></li>
<li><p>Impute the counterfacturals <span class="math inline">\(E[Y_{a^*m}]\)</span>, <span class="math inline">\(E[Y_{am}]\)</span>, <span class="math inline">\(E[Y_{a^*Ga^*}]\)</span>, <span class="math inline">\(E[Y_{aGa}]\)</span>, <span class="math inline">\(E[Y_{aGa^*}]\)</span> and <span class="math inline">\(E[Y_{a^*Ga}]\)</span>.</p>
<ul>
<li>Impute <span class="math inline">\(E[Y_{a^*m}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a^*,M=m,L=L_{a^*,i},C=C_i]\}_{i=1,...,n}\)</span>;</li>
<li>Impute <span class="math inline">\(E[Y_{am}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a,M=m,L=L_{a,i},C=C_i]\}_{i=1,...,n}\)</span>;</li>
<li>Impute <span class="math inline">\(E[Y_{a^*Ga^*}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a^*,M=G_{a^*,i},L=L_{a^*,i},C=C_i]\}_{i=1,...,n}\)</span>;</li>
<li>Impute <span class="math inline">\(E[Y_{aGa}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a,M=G_{a,i},L=L_{a,i},C=C_i]\}_{i=1,...,n}\)</span>;</li>
<li>Impute <span class="math inline">\(E[Y_{aGa^*}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a,M=G_{a^*,i},L=L_{a,i},C=C_i]\}_{i=1,...,n}\)</span>;</li>
<li>Impute <span class="math inline">\(E[Y_{a^*Ga}]\)</span> by taking a weighted average of <span class="math inline">\(\{E[Y_i|A=a^*,M=G_{a,i},L=L_{a^*,i},C=C_i]\}_{i=1,...,n}\)</span>,</li>
</ul></li>
<li><p>Calculate causal effects with formulas in table 3 or table 4.</p></li>
</ol>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
